<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Apollo | Rohan Bansal</title>
  
  <subtitle>Rohan Bansal</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://blog.rohanbansal.me/"/>
  <description>My musings, experiences, and tech talks</description>
  <updated>2020-10-28T03:13:00.083Z</updated>
  <id>http://blog.rohanbansal.me/</id>
  
  <author>
    <name>Rohan Bansal</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Workshop - Meme Songs With Arduino</title>
    <link href="http://blog.rohanbansal.me/2020/10/27/Workshop-Meme-Songs-With-Arduino/"/>
    <id>http://blog.rohanbansal.me/2020/10/27/Workshop-Meme-Songs-With-Arduino/</id>
    <published>2020-10-28T03:11:58.000Z</published>
    <updated>2020-10-28T03:13:00.083Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Meme-Songs-with-Arduino"><a href="#Meme-Songs-with-Arduino" class="headerlink" title="Meme Songs with Arduino"></a>Meme Songs with Arduino</h1><p><img src="https://cloud-psj7hfkrk.vercel.app/0thumbnail.png" class="lazyload" data-srcset="https://cloud-psj7hfkrk.vercel.app/0thumbnail.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="thumbnail"></p><h2 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h2><p>Meme songs are everywhere! I bet you (the reader) have been rickrolled at least once, or heard All Star/the Coffin Dance around the internet. In this beginner workshop, you’ll be building/coding an Arduino circuit that will be able to play music!</p><p>We are going to use Tinkercad’s interactive circuit builder, which is excellent; it’s like building an Arduino circuit in real life. With the expertise you gain from building this circuit online, recreating it with physical components should be a breeze!</p><p><strong>What You’ll Learn</strong></p><ul><li>How to wire a circuit, taking into account ground/power/signal</li><li>How to code in the Arduino C language</li></ul><p><strong>What You’ll Need</strong></p><ul><li>Extremely basic knowledge of any programming language, does not have to be Arduino C</li><li>Basic knowledge of music notes</li></ul><p><strong>Final Circuit</strong></p><ul><li>Here’s the demo/final code: <a href="https://www.tinkercad.com/things/92aTTFLqRgP" target="_blank" rel="noopener">demo</a> </li></ul><hr><h2 id="Setup"><a href="#Setup" class="headerlink" title="Setup"></a>Setup</h2><p>Let’s get started! Head over to <a href="https://www.tinkercad.com" target="_blank" rel="noopener">tinkercad</a> and register for an account in the top right. You should then be redirected to a dashboard, at which point you can create a new circuit diagram. Refer to the GIF below if you’re having trouble:</p><p><img src="https://cloud-98eknqy7u.vercel.app/0createproject.gif" class="lazyload" data-srcset="https://cloud-98eknqy7u.vercel.app/0createproject.gif" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="createproject"></p><h2 id="The-Physics-of-Music"><a href="#The-Physics-of-Music" class="headerlink" title="The Physics of Music"></a>The Physics of Music</h2><p>Music, in general terms, can be described as sound. Very pleasant, bop-worthy sound! If we were to abstract sound even further, it can be thought of as waves that look like this: </p><p><img src="https://www.teachmeaudio.com/application/files/4115/8670/6247/sine-wave.svg" class="lazyload" data-srcset="https://www.teachmeaudio.com/application/files/4115/8670/6247/sine-wave.svg" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="soundwaves"></p><p>Basic science lesson time! The humps of the wave are called wave crests, and the valley are troughs.  Wavelength is the distance between two adjacent crests on the wave. The important part, though, is the <a href="https://www.wikiwand.com/en/Frequency" target="_blank" rel="noopener"><strong>frequency</strong></a>. This is how many times a wavelength passes a fixed point in a given amount of time–frequency is measured in <a href="https://www.wikiwand.com/en/Hertz" target="_blank" rel="noopener">hertz</a>. </p><p>What’s the point, you say? The frequency of the wave is directly related to what you hear! The higher the frequency, the higher the <a href="https://www.wikiwand.com/en/Pitch_(music)" target="_blank" rel="noopener">pitch</a>, and vice versa. This forms the basis for <a href="https://www.wikiwand.com/en/Musical_note" target="_blank" rel="noopener"><strong>music notes</strong></a>. </p><p>This is important because Arduino has no idea what a music note is, and neither does the buzzer we’ll be programming. To specify what note we want to play, we need to give Arduino the hertz value. For example, the note C4 is about 261.6 hz! For a full list of notes and their frequencies, check out <a href="https://pages.mtu.edu/~suits/notefreqs.html" target="_blank" rel="noopener">this link</a>. We’ll be using that list soon to arrange the coffin dance.</p><h2 id="Building-the-Circuit"><a href="#Building-the-Circuit" class="headerlink" title="Building the Circuit"></a>Building the Circuit</h2><p>Now that we have a new project window open, you’ll see multiple things:</p><p><img src="https://cloud-7anwdjqtl.vercel.app/0workspace.png" class="lazyload" data-srcset="https://cloud-7anwdjqtl.vercel.app/0workspace.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="workspace"></p><p>Here’s a rundown of the items in each rectangle, from left to right:</p><p><em>Red</em> : the name/title of your project</p><p><em>Green</em> : a few actions pertinent to devices, such as rotate, delete, undo/redo, etc.</p><p><em>Blue</em> : the code window toggle button, simulate button, and methods to export/share</p><p><em>Yellow</em>: the components window with a huge variety of devices to use</p><p>Now, we have to do two things to start off. Rename the project by clicking the name in the top left, and drag in an Arduino from the left components bar!</p><p><img src="https://cloud-ot05nrpna.vercel.app/0rename_and_arduino.gif" class="lazyload" data-srcset="https://cloud-ot05nrpna.vercel.app/0rename_and_arduino.gif" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="rename_plus_arduino"></p><p>We also need to add the components that will be making music in the first place–piezos! Piezo is short for <a href="https://en.wikipedia.org/wiki/Buzzer#Piezoelectric_2" target="_blank" rel="noopener">piezoelectric speaker</a>, an oscillating circuit that projects a sound wave. Go ahead drag <strong>two piezos</strong> into the main view, along with  <strong>two resistors.</strong> If you can’t find them, use the search bar. </p><p>You should have this so far:</p><p><img src="https://cloud-mu05rgdue.vercel.app/0screenshot_from_2020-10-20_18-20-31.png" class="lazyload" data-srcset="https://cloud-mu05rgdue.vercel.app/0screenshot_from_2020-10-20_18-20-31.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="piezo_and_resistors"> </p><p>Like any electrical device, a circuit needs to be completed to activate it. In the piezo’s case, it needs a signal (aka power) and ground. </p><p>Ground always connects to the Arduino’s ground port (next to pin 13 at the top of the board), but since a signal is variable, it can be connected to any of the digital pins.</p><p>I won’t go into detail about digital pins and analog pins, but you can definitely learn more <a href="https://learn.sparkfun.com/tutorials/analog-vs-digital/all" target="_blank" rel="noopener">here</a>. All you need to know for this workshop is that the hertz value inputted into code is going to be sent over the signal pin to the piezo.</p><p>Next, we need to configure the resistors to the right resistance value. This ensures the signal sent to the piezos does not exceed a certain limit and is smooth. Click both resistors and change the resistance values in the box in the top right to the below:</p><p><img src="https://cloud-q7ciep09e.vercel.app/0resistor_config.png" class="lazyload" data-srcset="https://cloud-q7ciep09e.vercel.app/0resistor_config.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="resistor_config"> </p><p>You can ignore the name field, as that isn’t important to the circuit, just for labeling purposes. Make sure that the dropdown is set to plain <a href="ynderhost.com/">ohms</a> (symbol for electrical resistance).</p><p>It’s time to wire up the circuit! By clicking a port on either the piezo, resistor, or Arduino, you should be able to create a wire. Wire the circuit as below:</p><p><img src="https://cloud-o5uuil1gg.vercel.app/0correct_wiring.png" class="lazyload" data-srcset="https://cloud-o5uuil1gg.vercel.app/0correct_wiring.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="correct_wiring"> </p><p>Let’s go over the elements of this diagram. Following pin 6, the signal wire first connects to a resistor, which connects to one piezo’s signal input. The piezo’s other port routes the electricity to ground, completing the circuit. The mini-circuit is the same for pin 7! Don’t be intimidated by electronics, in hindsight it can be very simple.</p><p>Hooray! You finished <strong>building the circuit</strong>. Time to play some meme music!</p><h2 id="Programming-the-Circuit"><a href="#Programming-the-Circuit" class="headerlink" title="Programming the Circuit"></a>Programming the Circuit</h2><p>Remember the code window toggle button in the blue rectangle in the picture earlier? Go ahead and click that and toggle from block code to text code. Here’s how to do that:</p><p><img src="https://cloud-g16ym3hgq.vercel.app/0convert_to_textcode.gif" class="lazyload" data-srcset="https://cloud-g16ym3hgq.vercel.app/0convert_to_textcode.gif" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="convert_code_type"></p><p>We’re now ready to start coding! Go ahead and delete everything in the window and type out the following:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setup</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">loop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>The <code>setup()</code> function is only run once during the entire runtime: at the beginning. You can think of it as setting up the program for what’s to come.</p><p>The <code>loop()</code> function is run probably hundreds of times a second!  It loops repeatedly, until the program either crashes or decidedly ends.</p><p>For the purposes of this workshop, you don’t need to know what <code>void</code> does; if you want to, check this out: <a href="https://www.geeksforgeeks.org/java-identifiers/" target="_blank" rel="noopener">identifier</a> (the link takes you to a Java tutorial, but in terms of identifiers, everything is the same)</p><p>In the <code>setup()</code> function, we have to do 2 things:</p><ul><li>tell the Arduino we’re going to use pin 6</li><li>tell the Arduino we’re going to use pin 7</li></ul><p>To do this, we need to specify that both those pins are going to be outputs, not inputs (since we’re transmitting sound <em>from</em> the Arduino <em>to</em> the piezos):</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setup</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">pinMode</span>(<span class="number">6</span>, <span class="literal">OUTPUT</span>);</span><br><span class="line">  <span class="built_in">pinMode</span>(<span class="number">7</span>, <span class="literal">OUTPUT</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>There are multiple pin modes besides OUTPUT, we just won’t use them for this workshop. To learn more, check out <a href="https://www.arduino.cc/reference/en/language/functions/digital-io/pinmode/" target="_blank" rel="noopener">this link</a>. </p><p>Let’s try making some basic sounds! In the <code>loop()</code> function, add the following and hit the <strong>Start Simulation</strong> button when done. You should hear one note being played repeatedly!</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">loop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">tone</span>(<span class="number">6</span>, <span class="number">261</span>, <span class="number">1000</span>);</span><br><span class="line">    <span class="built_in">delay</span>(<span class="number">1000</span>);</span><br><span class="line">    <span class="built_in">noTone</span>(<span class="number">6</span>);</span><br><span class="line">    <span class="built_in">delay</span>(<span class="number">200</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Line by line:</p><ol><li>we call a built-in tone function that takes the following as parameters (left to right): pin number, hertz (note), duration (milliseconds)</li><li>delay the program by 1000 milliseconds to allow the tone to play out</li><li>disable the tone from the piezo connected to pin 6</li><li>delay again for 200 milliseconds to allow for a grace period between notes</li></ol><p>Now, the point of having two piezos is for the sound to alternate between them! To do this, we need to keep track of the current speaker being used. Go ahead and add a variable that does this at the very top of the file, we’ll come back to it later:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> currentSpeaker = <span class="number">6</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setup</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">pinMode</span>(<span class="number">6</span>, <span class="literal">OUTPUT</span>);</span><br><span class="line">  <span class="built_in">pinMode</span>(<span class="number">7</span>, <span class="literal">OUTPUT</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">loop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">tone</span>(<span class="number">6</span>, <span class="number">261</span>, <span class="number">1000</span>);</span><br><span class="line">    <span class="built_in">delay</span>(<span class="number">1000</span>);</span><br><span class="line">    <span class="built_in">noTone</span>(<span class="number">6</span>);</span><br><span class="line">    <span class="built_in">delay</span>(<span class="number">200</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>This code works, and we can by all means create a song with this, but typing out <em>four lines per note</em> is going to be a major hassle. This is where <a href="https://www.tutorialspoint.com/computer_programming/computer_programming_functions.htm" target="_blank" rel="noopener">functions</a>, reusable pieces of code, come in!</p><p>Let’s create a new function underneath <code>setup()</code> , called <code>play()</code> that takes in two values, hertz and wait time in milliseconds. </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">play</span><span class="params">(<span class="keyword">float</span> hz, <span class="keyword">int</span> wait)</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Let’s also assume we’re only going to be using the piezo on pin 6 for now. Add the following inside the <code>play()</code> function:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">play</span><span class="params">(<span class="keyword">float</span> hz, <span class="keyword">int</span> wait)</span> </span>&#123;</span><br><span class="line">  <span class="built_in">tone</span>(<span class="number">6</span>, hz, <span class="number">1000</span>);</span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">200</span>);</span><br><span class="line">  <span class="built_in">noTone</span>(<span class="number">6</span>);</span><br><span class="line">  <span class="built_in">delay</span>(wait);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>What did we do here? Since we’re only using the piezo on pin 6, why do we have to specify it all the time? To make our lives easier, we can add that manually to the function so when we call <code>play()</code>, no pin number is required. We also assume the delay and note length, as those will probably stay constant during this workshop.</p><p>Let’s test this function out! Delete all the code inside <code>loop()</code> , and add this instead:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">loop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    play(<span class="number">261</span>, <span class="number">500</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Hit the <strong>Start Simulation</strong> button, and you should hear a note playing repeatedly. This time, we only did it in <em>one line</em>!</p><p>How can we modify this now to alternate sounds between both piezos? Using <a href="https://www.programiz.com/c-programming/c-if-else-statement" target="_blank" rel="noopener"><code>if</code> statements</a>! Modify your <code>play()</code> function as below:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">play</span><span class="params">(<span class="keyword">float</span> hz, <span class="keyword">int</span> wait)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">tone</span>(currentSpeaker, hz, <span class="number">1000</span>);</span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">200</span>);</span><br><span class="line">  <span class="built_in">noTone</span>(currentSpeaker);</span><br><span class="line">  <span class="built_in">delay</span>(wait);</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">if</span>(currentSpeaker == <span class="number">6</span>) &#123;</span><br><span class="line">    currentSpeaker += <span class="number">1</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      currentSpeaker -= <span class="number">1</span>;</span><br><span class="line">  &#125;    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>What did we do here? Instead of setting the piezo manually, we have the <code>currentSpeaker</code> variable do it for us! Since the variable is set to either 6 or 7, it’s just a matter of switching between them every time the function is called. This is done with the if statement at the end; if the value is 6, it changes it to 7, and if it’s 7, it changes it back to 6.</p><p>Hit <strong>Start Simulation</strong> once more and you should see the sounds alternating from both piezos!</p><p><img src="https://cloud-62jdtr82i.vercel.app/tenor.gif" class="lazyload" data-srcset="https://cloud-62jdtr82i.vercel.app/tenor.gif" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="woohoo"></p><p>The hard part is done, let’s make some music now! Referring to <a href="https://pages.mtu.edu/~suits/notefreqs.html" target="_blank" rel="noopener">this link</a> with all the possible notes and frequencies, here’s how to play the coffin dance (replace <code>loop()</code> contents):</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">loop</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  play(<span class="number">329</span>, <span class="number">200</span>); <span class="comment">// F-4</span></span><br><span class="line">  play(<span class="number">329</span>, <span class="number">70</span>);  <span class="comment">// F-4</span></span><br><span class="line">  play(<span class="number">493</span>, <span class="number">100</span>); <span class="comment">// B-4</span></span><br><span class="line">  play(<span class="number">440</span>, <span class="number">200</span>); <span class="comment">// A-4</span></span><br><span class="line">  play(<span class="number">392</span>, <span class="number">200</span>); <span class="comment">// G-4</span></span><br><span class="line">  play(<span class="number">369.99</span>, <span class="number">100</span>); <span class="comment">// F#-4</span></span><br><span class="line">  play(<span class="number">369.99</span>, <span class="number">100</span>); <span class="comment">// F#-4</span></span><br><span class="line">  play(<span class="number">369.99</span>, <span class="number">120</span>); <span class="comment">// F#-4</span></span><br><span class="line">  play(<span class="number">440</span>, <span class="number">150</span>); <span class="comment">// A-4</span></span><br><span class="line">  play(<span class="number">392</span>, <span class="number">80</span>); <span class="comment">// G-4</span></span><br><span class="line">  play(<span class="number">369.99</span>, <span class="number">100</span>); <span class="comment">// F#-4</span></span><br><span class="line">  play(<span class="number">329</span>, <span class="number">150</span>); <span class="comment">// F-4</span></span><br><span class="line">  play(<span class="number">246.94</span>, <span class="number">150</span>); <span class="comment">// B-3</span></span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  play(<span class="number">392</span>, <span class="number">70</span>); <span class="comment">// G-4</span></span><br><span class="line">  play(<span class="number">369.99</span>, <span class="number">70</span>); <span class="comment">// F#-4</span></span><br><span class="line">  play(<span class="number">392</span>, <span class="number">70</span>); <span class="comment">// G-4</span></span><br><span class="line">  play(<span class="number">369.99</span>, <span class="number">70</span>); <span class="comment">// F#-4</span></span><br><span class="line">  play(<span class="number">392</span>, <span class="number">70</span>); <span class="comment">// G-4</span></span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  play(<span class="number">329</span>, <span class="number">150</span>); <span class="comment">// F-4</span></span><br><span class="line">  play(<span class="number">246.94</span>, <span class="number">150</span>); <span class="comment">// B-3</span></span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  play(<span class="number">392</span>, <span class="number">70</span>); <span class="comment">// G-4</span></span><br><span class="line">  play(<span class="number">369.99</span>, <span class="number">70</span>); <span class="comment">// F#-4</span></span><br><span class="line">  play(<span class="number">392</span>, <span class="number">70</span>); <span class="comment">// G-4</span></span><br><span class="line">  play(<span class="number">369.99</span>, <span class="number">70</span>); <span class="comment">// F#-4</span></span><br><span class="line">  play(<span class="number">392</span>, <span class="number">70</span>); <span class="comment">// G-4</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Go ahead and paste that in and hit <strong>Run Simulation</strong> if you want to hear the coffin dance. I put in the note names in the comments besides each note so you can reference the note frequencies page above to create your own songs!</p><p>The final code is available in the demo at the top of this page. If you have a syntax error or a logic error, go ahead and cross-check against that.</p><h2 id="Further-Hacking"><a href="#Further-Hacking" class="headerlink" title="Further Hacking"></a>Further Hacking</h2><p><img src="https://cloud-mlx5oz5hm.vercel.app/tenor.gif" class="lazyload" data-srcset="https://cloud-mlx5oz5hm.vercel.app/tenor.gif" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="yay"></p><p>This program went over the basics of how to make music; there’s a lot to be changed! See if you can mess with note durations to create chords (since Arduino does not support playing multiple notes at once), arrange your own songs, etc. If you think your creation is epic, please do share it with the Hack Club community!</p><p>Here are some branches of the project that build upon the code written in this workshop:</p><ul><li><strong>Third Piezo</strong>: <a href="https://www.tinkercad.com/things/hNY47uC3iJF" target="_blank" rel="noopener">demo and code</a></li><li><strong>All Star, by Smash Mouth</strong>: <a href="https://www.tinkercad.com/things/fMHcz0D6nag" target="_blank" rel="noopener">demo and code</a></li><li><strong>Fake Chords</strong>: <a href="https://www.tinkercad.com/things/dgJta8YNPuA" target="_blank" rel="noopener">demo and code</a></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Meme-Songs-with-Arduino&quot;&gt;&lt;a href=&quot;#Meme-Songs-with-Arduino&quot; class=&quot;headerlink&quot; title=&quot;Meme Songs with Arduino&quot;&gt;&lt;/a&gt;Meme Songs with A</summary>
      
    
    
    
    
    <category term="workshop, memes, arduino, tinkercad, coffin dance" scheme="http://blog.rohanbansal.me/tags/workshop-memes-arduino-tinkercad-coffin-dance/"/>
    
  </entry>
  
  <entry>
    <title>Workshop - Templated Robot Emails</title>
    <link href="http://blog.rohanbansal.me/2020/09/19/Workshop-Templated-Robot-Emails/"/>
    <id>http://blog.rohanbansal.me/2020/09/19/Workshop-Templated-Robot-Emails/</id>
    <published>2020-09-19T23:03:58.000Z</published>
    <updated>2020-09-19T23:05:01.803Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Robotic-Emails"><a href="#Robotic-Emails" class="headerlink" title="Robotic Emails"></a>Robotic Emails</h1><p><img src="https://cloud-48mv5ovk7.vercel.app/email.png" class="lazyload" data-srcset="https://cloud-48mv5ovk7.vercel.app/email.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="Robot With Emails"></p><h2 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h2><hr><p>In this workshop, you’ll be using good ol’ Python to send emails using a customizable template! The project should take about 20-30 minutes to complete.</p><p>Here are some links to the final code and a live demo (<a href="https://repl.it" target="_blank" rel="noopener">repl.it</a>):</p><p><em>Final Code: <a href="https://github.com/hackclub/hackclub/tree/main/workshops/robot_emails" target="_blank" rel="noopener">GitHub</a></em></p><p><em>Demo: <a href="https://repl.it/@apexblade/RoboticEmails#main.py" target="_blank" rel="noopener">Live</a></em></p><p><strong>Prerequisites</strong></p><ul><li>A Google account, preferably with <a href="https://www.google.com/landing/2step/" target="_blank" rel="noopener">2FA</a> disabled</li></ul><hr><h2 id="Initial-Setup"><a href="#Initial-Setup" class="headerlink" title="Initial Setup"></a>Initial Setup</h2><p><a href="https://www.wikiwand.com/en/Simple_Mail_Transfer_Protocol" target="_blank" rel="noopener">SMTP</a> (Simple Mail Transfer Protocol) has been getting more and more secure as of late; and for good reason. To be able to send emails from your Google account, we need to give our python application access.</p><p>Head over to <a href="https://myaccount.google.com/u/0/lesssecureapps?hl=en" target="_blank" rel="noopener">this link</a> and flick the “Allow less secure apps” lever to the on position. Google strictly allows only its own or verified software to interface with the creation/sending of emails; since you’re creating a python app, it’s necessary to tell Google that it’s acceptable.</p><p><img src="https://cloud-f9wuongol.vercel.app/app_access.png" class="lazyload" data-srcset="https://cloud-f9wuongol.vercel.app/app_access.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="less secure app access"></p><p>You will also need to complete <a href="https://accounts.google.com/b/0/DisplayUnlockCaptcha" target="_blank" rel="noopener">this captcha</a> to enable access for the next application that uses your credentials (this one). </p><p><em>Quick Note</em>s</p><p>If you happen to have 2 Factor Authentication enabled for your account, please follow <a href="https://support.google.com/accounts/answer/185833?hl=en" target="_blank" rel="noopener">this article</a> to generate an app password. When we write the program and input our account password, replace that with the app password you generated.</p><p>After working on this project, it is recommended to turn the less secure apps lever back to it’s off position.</p><hr><h2 id="File-Setup"><a href="#File-Setup" class="headerlink" title="File Setup"></a>File Setup</h2><p>Head over to <a href="https://repl.it" target="_blank" rel="noopener">repl.it</a> and create a new <code>Python3</code> project. In the sidebar, a <code>main.py</code> file should already be created. Go ahead and create two more files:</p><ul><li><code>contacts.txt</code></li><li><code>message.txt</code></li></ul><p>The <code>contacts.txt</code> file will contain emails and names that will be substituted into the message body later (can be customized). Feel free to add an email and a name to it, bu make sure it’s formatted exactly as below:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bobsmith@johndoe.com, Bob</span><br></pre></td></tr></table></figure><p>In the <code>message.txt</code> file, add the following template, which we will process in our python script.</p><ul><li>The first line contains the subject of the email</li><li>The rest of the lines contain the body</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Test Email</span><br><span class="line"></span><br><span class="line">Dear &#123;0&#125;,</span><br><span class="line"></span><br><span class="line">    Bacon ipsum dolor amet venison ball tip hamburger tenderloin bresaola ribeye pancetta ham chuck rump buffalo. T-bone cow pork, capicola jerky short loin prosciutto picanha porchetta ribeye. Pig ground round shank frankfurter drumstick, pork belly bresaola tongue. Pancetta alcatra bacon ground round kielbasa beef landjaeger cupim prosciutto sirloin tongue jowl.</span><br><span class="line"></span><br><span class="line">Sincerely,</span><br><span class="line">&lt;Your Name&gt;</span><br></pre></td></tr></table></figure><p>Please substitute <code>&lt;Your Name&gt;</code> with your name, as this won’t be substituted automatically in this workshop (feel free to add it in later though)! </p><p><em>Quick Note</em></p><p>Wondering where I got that spicy placeholder text? Check out <a href="https://baconipsum.com/?paras=5&type=all-meat&start-with-lorem=1" target="_blank" rel="noopener">Bacon Ipsum</a>.</p><hr><h2 id="Writing-Code"><a href="#Writing-Code" class="headerlink" title="Writing Code"></a>Writing Code</h2><p>I’ll take this moment to ask you <strong>not to copy and paste</strong>. It takes away from the learning experience (and in many cases, things need replacing).</p><p>At the top of your <code>main.py</code> file, go ahead and add the following imports:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> smtplib</span><br><span class="line"><span class="keyword">from</span> email.mime.multipart <span class="keyword">import</span> MIMEMultipart</span><br><span class="line"><span class="keyword">from</span> email.mime.text <span class="keyword">import</span> MIMEText</span><br></pre></td></tr></table></figure><ul><li><a href="https://docs.python.org/3/library/smtplib.html" target="_blank" rel="noopener"><code>smtplib</code></a> is a Python module used to send emails, utilizing the Simple Mail Transfer Protocol</li><li><a href="https://docs.python.org/3/library/email.html" target="_blank" rel="noopener"><code>email</code></a> is a Python module not used to send emails, but to manage email contents</li><li><a href="https://docs.python.org/3/library/email.mime.html" target="_blank" rel="noopener"><code>email.mime</code></a> is a library that uses the global <a href="https://www.wikiwand.com/en/MIME" target="_blank" rel="noopener">MIME internet standard</a> to format email messages</li><li><code>sys</code> is a system library used to deal with file and program operations, and <code>time</code> is just used for delays (in our case)</li></ul><p>Next, lets create some variables to hold our credentials.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">address = <span class="string">'bobsmith@johndoe.com'</span></span><br><span class="line">password = <span class="string">'&lt;password&gt;'</span></span><br></pre></td></tr></table></figure><p>Lets also initialize a connection to the Gmail SMTP mail server with those credentials.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mail = smtplib.SMTP(<span class="string">'smtp.gmail.com'</span>, <span class="number">587</span>)</span><br><span class="line">mail.ehlo()</span><br><span class="line">mail.starttls()</span><br><span class="line">mail.login(address, password)</span><br></pre></td></tr></table></figure><ul><li>The <a href="https://docs.python.org/2/library/smtplib.html" target="_blank" rel="noopener"><code>mail.ehlo()</code></a> function is the application’s way of identifying itself to the server. More info <a href="https://help.returnpath.com/hc/en-us/articles/220223328-What-is-Extended-HELO-EHLO-" target="_blank" rel="noopener">here</a>. </li><li>The <a href="https://docs.python.org/2/library/smtplib.html" target="_blank" rel="noopener"><code>mail.starttls()</code></a> function ensures that the connection is secure. More info <a href="https://www.wikiwand.com/en/Transport_Layer_Security" target="_blank" rel="noopener">here</a>.</li></ul><h3 id="Getting-Contacts"><a href="#Getting-Contacts" class="headerlink" title="Getting Contacts"></a>Getting Contacts</h3><p>Now, let’s obtain our contacts from the <code>contacts.txt</code> file! (You don’t have to write the comments, but it’s great practice if you do)</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_contacts</span><span class="params">(filename)</span>:</span> <span class="comment"># input the contacts file</span></span><br><span class="line">    contacts_list = &#123;&#125; <span class="comment"># initialize dictionary </span></span><br><span class="line">    <span class="keyword">with</span> open(filename, mode = <span class="string">'r'</span>, encoding = <span class="string">'utf-8'</span>) <span class="keyword">as</span> f: <span class="comment"># open the contacts file, read only mode</span></span><br><span class="line">        contacts = f.read().split(<span class="string">'\n'</span>) <span class="comment"># split lines, add to a list</span></span><br><span class="line">        f.seek(<span class="number">0</span>) <span class="comment"># look at the beginning of the file</span></span><br><span class="line">        first = f.read() <span class="comment"># read the beginning of the file</span></span><br><span class="line">        <span class="keyword">if</span> first == <span class="string">''</span>: <span class="comment"># if it's empty, there are no contacts, print error</span></span><br><span class="line">            print(<span class="string">'Contacts file is empty.'</span>)</span><br><span class="line">            sys.exit() <span class="comment"># exit the program</span></span><br><span class="line">    <span class="keyword">for</span> item <span class="keyword">in</span> contacts: <span class="comment"># iterate through contacts, add names and emails separately to a dictionary</span></span><br><span class="line">        contacts_list[item.split(<span class="string">', '</span>)[<span class="number">0</span>]] = item.split(<span class="string">', '</span>)[<span class="number">1</span>:]</span><br><span class="line">    <span class="keyword">return</span> contacts_list <span class="comment"># return contacts dictionary</span></span><br></pre></td></tr></table></figure><p>Important elements:</p><ul><li><code>contacts_list</code> is a dictionary we create to hold our emails and names in <code>key:value</code> format</li><li><code>with open...</code> is a python method of opening a file, reading it to an object (in our case), and closing it immediately after. We open it in <code>r</code> (reading) mode, to make sure nothing is written to the file on accident</li><li><a href="https://www.wikiwand.com/en/UTF-8" target="_blank" rel="noopener"><code>utf-8</code></a> is a character encoding</li><li><code>\n</code> is a newline character in Python; by splitting a file by <code>\n</code>, we are essentially splitting up all the lines</li><li><code>contacts_list[item.split(&#39;, &#39;)[0]] = item.split(&#39;, &#39;)[1:]</code> adds the email and all the substitutions associated with that email to a dictionary. The format is <code>key: [value, another_value, etc.]</code></li></ul><h3 id="Reading-the-Message"><a href="#Reading-the-Message" class="headerlink" title="Reading the Message"></a>Reading the Message</h3><p>Great! You’re basically 1/3 of the way there!</p><p><img src="https://cloud-62jdtr82i.vercel.app/tenor.gif" class="lazyload" data-srcset="https://cloud-62jdtr82i.vercel.app/tenor.gif" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="woohoo"></p><p>Add another function called <code>read_message</code> to the <code>main.py</code> file:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">read_message</span><span class="params">(filename)</span>:</span> <span class="comment">## input the message file</span></span><br><span class="line">    <span class="keyword">with</span> open(filename, <span class="string">'r'</span>, encoding = <span class="string">'utf-8'</span>) <span class="keyword">as</span> template: <span class="comment">#open the file in read mode</span></span><br><span class="line">        template_content = template.read() <span class="comment"># read the contents of the file to a variable</span></span><br><span class="line">        template.seek(<span class="number">0</span>) <span class="comment"># look at the beginning of the file</span></span><br><span class="line">        <span class="keyword">if</span> template_content == <span class="string">''</span>: <span class="comment"># if empty, message is empty</span></span><br><span class="line">            print(<span class="string">'Message file is empty.'</span>)</span><br><span class="line">            sys.exit() <span class="comment"># quit program</span></span><br><span class="line">        subject = template_content.splitlines()[<span class="number">0</span>].rstrip() <span class="comment"># obtain the first line (subject) by splitting all lines and indexing the first (0)</span></span><br><span class="line">    <span class="keyword">return</span> subject, <span class="string">'\n'</span>.join(template_content.split(<span class="string">'\n'</span>)[<span class="number">1</span>:]) <span class="comment"># return the subject and the body</span></span><br></pre></td></tr></table></figure><p>A few things to note:</p><ul><li>The <code>read_message()</code> function is really similar to the contacts function!</li></ul><p>Lets go over:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">template_content.splitlines()[<span class="number">0</span>].rstrip()</span><br></pre></td></tr></table></figure><p>We split the file into multiple lines in a list. From there, we obtain the first line, which is the subject, then we strip all the spaces to the right of the text. This is to ensure there isn’t a stray <code>\n</code> added by the text editor!</p><p>This is also a particularly tricky part:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'\n'</span>.join(template_content.split(<span class="string">'\n'</span>)[<span class="number">1</span>:])</span><br></pre></td></tr></table></figure><p>This line basically removes the subject line from the body of the email! Since the text is read from the message file and the subject has already been parsed, it’s not a good idea to send the subject again in the body. We split the content by newlines and keep everything after the first line; <code>[1:]</code> is the list operation that does this. More info <a href="https://www.w3schools.com/python/python_lists.asp" target="_blank" rel="noopener">here</a>!</p><p>Test out both of these functions by printing their results! Here’s how to do it:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">contacts = get_contacts(<span class="string">'contacts.txt'</span>)</span><br><span class="line">subject, template_content = read_message(<span class="string">'message.txt'</span>)</span><br><span class="line">print(contacts)</span><br><span class="line">print(subject, template_content)</span><br></pre></td></tr></table></figure><p>After doing this, go ahead and remove the print statements, but keep the variable declarations (needed in the next section).</p><p>If you get an SMTP error, you need to go back to <a href="https://accounts.google.com/b/0/DisplayUnlockCaptcha" target="_blank" rel="noopener">this link</a> and complete the captcha again.</p><h3 id="Formatting-and-Sending-the-Email"><a href="#Formatting-and-Sending-the-Email" class="headerlink" title="Formatting and Sending the Email"></a>Formatting and Sending the Email</h3><p>You can format and send this email in only 12 lines of code:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> contact_mail <span class="keyword">in</span> list(contacts):</span><br><span class="line">    msg = MIMEMultipart()</span><br><span class="line">    msg_body = template_content.format(*tuple(contacts[contact_mail]))</span><br><span class="line">    </span><br><span class="line">    msg[<span class="string">'From'</span>] = address</span><br><span class="line">    msg[<span class="string">'To'</span>] = contact_mail</span><br><span class="line">    msg[<span class="string">'Subject'</span>] = subject</span><br><span class="line"></span><br><span class="line">    msg.attach(MIMEText(msg_body, <span class="string">'plain'</span>))</span><br><span class="line">    print(msg)</span><br><span class="line">    mail.sendmail(address, contact_mail, msg.as_string())</span><br><span class="line">    print(<span class="string">"Sent Successfully!"</span>)</span><br><span class="line"></span><br><span class="line">mail.quit()</span><br></pre></td></tr></table></figure><p>Here’s our first occurrence of <code>MIMEMultipart()</code>. This, as explained at the top, manages the content of the email according to a universal internet standard. There’s more in-depth info <a href="https://www.wikiwand.com/en/MIME" target="_blank" rel="noopener">here</a>. </p><p>Let’s remember that our <code>contacts</code> variable is a dictionary. We need to access both the emails and substitutions associated with them. That’s where this line comes in, and does multiple things at once:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msg_body = template_content.format(*tuple(contacts[contact_mail]))</span><br></pre></td></tr></table></figure><p>If you noticed in the <code>contacts.txt</code> file, the substitution is represented by a <code>{0}</code> . If you’ve done Python string formatting before, you may realize that character sequence allows for replacement with the <a href="https://www.w3schools.com/python/ref_string_format.asp" target="_blank" rel="noopener"><code>.format()</code></a> function! </p><ul><li>We first obtain the list of substitutions with <code>contacts[contact_mail]</code> - this returns a list, as explained when we wrote the <code>get_contacts()</code> function</li><li><code>tuple</code> is an <a href="https://www.wikiwand.com/en/Immutable_object" target="_blank" rel="noopener">immutable</a> data type in Python. When we write <code>*tuple()</code>, we unpack the list of substitutions as arguments for the <code>format()</code> function</li><li><code>template_content.format()</code> - since template_content is a string, we can use the format function to replace the <code>{0}</code> with custom arguments!</li></ul><p>The following chunk from above attaches the body to the email in MIME format, and sends the email!</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">msg.attach(MIMEText(msg_body, <span class="string">'plain'</span>))</span><br><span class="line">print(msg)</span><br><span class="line">mail.sendmail(address, contact_mail, msg.as_string())</span><br></pre></td></tr></table></figure><p>At this point, go ahead and <strong>run the program</strong>. Assuming your email and password are correct, and you let your application access your Google account, the program should run successfully! Go check the emails of the contacts you wrote down.</p><p>The result should be similar to this: </p><p><img src="https://cloud-a1v5o0pxe.vercel.app/code_result.png" class="lazyload" data-srcset="https://cloud-a1v5o0pxe.vercel.app/code_result.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="result"></p><p>If you’re having problems, go check the final code up at the top of this page and make sure you didn’t make any errors. </p><hr><h2 id="Further-Hacking"><a href="#Further-Hacking" class="headerlink" title="Further Hacking"></a>Further Hacking</h2><p><img src="https://cloud-mlx5oz5hm.vercel.app/tenor.gif" class="lazyload" data-srcset="https://cloud-mlx5oz5hm.vercel.app/tenor.gif" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="yay"></p><p>There are many things that can be changed in this program. Go back and see what you can modify to make it your own! Because of the modularity of the project, to add another substitution, it’s as simple as adding a <code>{1}</code> or a <code>{2}</code>  in <code>message.txt</code> and adding more commas and arguments in <code>contacts.txt</code>. Try to think of ways to make the project even better, and please share with me or others in the Hack Club community!</p><p>Here are some branches of the project that build upon the code (can also be found on <a href="https://github.com/hackclub/hackclub" target="_blank" rel="noopener">GitHub</a>)</p><ul><li><strong>Switching Mail Servers</strong>: <a href="https://repl.it/@apexblade/RoboticEmails-MailServerSwitch" target="_blank" rel="noopener">demo and code</a> <ul><li>Easily send templated emails from multiple accounts and smtp servers! </li></ul></li><li><strong>Company Sponsor Email</strong>: <a href="https://repl.it/@apexblade/RoboticEmails-SponsorEmail#main.py" target="_blank" rel="noopener">demo and code</a> <ul><li>An example of how far you can go with this project! In retrospect, it has hundreds of usages.</li></ul></li><li><strong>Multiple Messages</strong>: <a href="https://repl.it/@apexblade/RoboticEmails-SwitchableMessages" target="_blank" rel="noopener">demo and code</a><ul><li>Multiple presets for emails, select one and send!</li></ul></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Robotic-Emails&quot;&gt;&lt;a href=&quot;#Robotic-Emails&quot; class=&quot;headerlink&quot; title=&quot;Robotic Emails&quot;&gt;&lt;/a&gt;Robotic Emails&lt;/h1&gt;&lt;p&gt;&lt;img src=&quot;https://clou</summary>
      
    
    
    
    
    <category term="workshop, email, python" scheme="http://blog.rohanbansal.me/tags/workshop-email-python/"/>
    
  </entry>
  
  <entry>
    <title>2D Game Development with Heaps.io and Haxe</title>
    <link href="http://blog.rohanbansal.me/2020/07/24/Game-Development-with-Heaps-io-and-Haxe/"/>
    <id>http://blog.rohanbansal.me/2020/07/24/Game-Development-with-Heaps-io-and-Haxe/</id>
    <published>2020-07-24T17:31:03.000Z</published>
    <updated>2020-09-21T18:14:53.828Z</updated>
    
    <content type="html"><![CDATA[<p><em>30 minutes to 1 hour read time. Get cozy with ur laptop or PC!</em></p><p>This post is meant for people who have experience in the <strong>Haxe high-level programming language</strong>, intending to make <strong>GPU-accelerated</strong>, <strong>high performance</strong> <strong>2 dimensional</strong> games in Heaps.io. This article details what Heaps is, how to get started, and many functions that one requires as a game developer. I will be adding my own experiences here and there for clarity. Note that this guide is only for <strong>2D Heaps.io</strong>, 3D you will have to look elsewhere. </p><h2 id="What-is-Heaps-io"><a href="#What-is-Heaps-io" class="headerlink" title="What is Heaps.io?"></a>What is Heaps.io?</h2><p>Heaps is a <strong>2D + 3D game development framework</strong> with hardware graphics acceleration support. Designed to be easily portable to new platforms, Heaps currently runs on Windows, macOS, Linux, HTML5, Android, Xbox One, Playstation 4, and Nintendo Switch. The 2D API in Heaps is similar to the Flash API (the scene graph is implemented as a Display List, just like in Flash), and at the same time, in Heaps, you can work with lower-level objects (shaders, buffers, vertices, etc.);</p><p><strong>Personal Note</strong></p><p>If you’ve worked with frameworks/editors like LibGDX, Unity, or UE4, Heaps.io is a leap in a different direction. As a nitty-gritty framework, you will have to invent specific mechanics yourself that are already included in others, such as physics and a camera (Heaps actually has a built-in camera, but it isn’t very developed). </p><p>Heaps.io also isn’t documented very well, but the source code is <em>extremely</em> legible and concise, so it almost makes up for that aspect. Many popular games like Dead Cells, Northgard, and even SpellBreak are developed in Heaps.io Haxe, so surpassing the steep learning curve is possible.</p><h2 id="Heaps-io-Package-Structure"><a href="#Heaps-io-Package-Structure" class="headerlink" title="Heaps.io Package Structure"></a>Heaps.io Package Structure</h2><p>Heaps classes are divided into <strong>4 categories (packages)</strong>:</p><ul><li><em>h2d</em> - 2D API</li><li><em>h3d</em> - 3D API</li><li><em>hxd</em> - generic classes for working with events, sounds, resources, etc.</li><li><em>hxsl</em> - classes related to the hxsl shader language</li></ul><h3 id="2D-Package-Base"><a href="#2D-Package-Base" class="headerlink" title="2D Package Base"></a>2D Package Base</h3><ul><li><em>h2d.Tile</em> - whole area or texture</li><li><em>h2d.Sprite</em> - Sprite, base class for displayable objects. The sprite itself cannot directly draw anything, but acts as a container for other objects</li><li><em>h2d.Bitmap</em> - an object that displays a texture on the screen or a specified area from a texture</li><li><em>h2d.Text</em> - respectively, an object that displays text on the screen</li></ul><h3 id="3D-Package-Base"><a href="#3D-Package-Base" class="headerlink" title="3D Package Base"></a>3D Package Base</h3><ul><li><em>h3d.scene.Object</em> - similarly to a sprite, it can act as a container for other objects in the 3d scene, but it does not itself store information about the geometry of objects on the scene</li><li><em>h3d.Camera</em> - a virtual camera through which you can watch the scene</li><li><em>h3d.scene.Mesh</em> - an object that has a geometry (for example, a cube or a sphere), as well as a material that describes how this geometry should be rendered, what shaders and textures should be used</li></ul><h3 id="Working-with-2D-and-3D-Together"><a href="#Working-with-2D-and-3D-Together" class="headerlink" title="Working with 2D and 3D Together"></a>Working with 2D and 3D Together</h3><p>Here are a few similar methods both rendering structures use:</p><ul><li>To add a nested object to the scene, both for 2D and 3D use the <code>addChild()</code> method</li><li>2D and 3D objects have a number of properties of the same name (<code>visible, scaleX, scaleY, name, etc.</code>)</li><li><em>hxd.Res</em> - macro-based resource management subsystem. It is a virtual file system with the ability to load data from different sources (from disk,  network, data embedded in the application itself)</li><li>Built-in event system (input events using mouse, keyboard, gamepad, network events).</li><li>System of shaders written in HxSL (Haxe Shader Language). HxSL shaders are essentially Haxe code and are directly embedded into the application code (without any quotes). Using macros, shaders are converted to the language supported on a specific target platform (glsl, hlsl, pssl).</li><li>Customizable rendering with support for modern graphic effects (for example, PBR). One of the ideas that was followed when creating Heaps is that any element of it could be easily changed. Therefore, the rendering in Heaps can be completely redone for your purposes, without making any changes to the code of the engine itself.</li></ul><h2 id="Compile-Targets"><a href="#Compile-Targets" class="headerlink" title="Compile Targets"></a>Compile Targets</h2><p>As already mentioned, Heaps can compile for different platforms:</p><ul><li><em>Flash</em> (used by Stage3D API) - You should not compile to this anymore, the platform is deprecated on major browsers</li><li><em>HTML5</em> (version 1.3.0 added support for WebGL 2)</li><li><em>HashLink</em> - A virtual machine used to run native apps. You can choose between SDL and DirectX, which are used to create the application window, draw graphics and handle events. On other desktop operating systems, only SDL is available. HashLink (and with it projects on Heaps) can also be built for modern game consoles (access to the code that provides support for these platforms is free, for access you need to contact Nicolas Cannasse). HashLink can compile to C code, making the developed game very fast.</li></ul><h2 id="Heaps-IDEs"><a href="#Heaps-IDEs" class="headerlink" title="Heaps IDEs"></a>Heaps IDEs</h2><p><strong>Personal Note</strong></p><p>I recommend using <a href="https://code.visualstudio.com/" target="_blank" rel="noopener">Visual Studio Code</a> to develop with Haxe and Heaps. It has a great plugin to aid debugging and development. <a href="https://www.jetbrains.com/idea/" target="_blank" rel="noopener">IntelliJ IDEA</a> and <a href="https://haxedevelop.org/" target="_blank" rel="noopener">HaxeDevelop</a> are other IDEs used to create Haxe applications.</p><p>Currently, HashLink applications are profiled by profiling the C code that is output (for example, using MS Visual Studio).</p><p>To work with the network, Nicolas recommends using his own hxbit library, an example of working with which is available in the examples distributed with Heaps - Network.hx.</p><h2 id="Installing-and-Configuring-the-Heaps-Environment"><a href="#Installing-and-Configuring-the-Heaps-Environment" class="headerlink" title="Installing and Configuring the Heaps Environment"></a>Installing and Configuring the Heaps Environment</h2><p>At the moment, the documentation says that Haxe version 3.4.2 or higher is required to work with Heaps. However, if you want to build a project for HashLink, then there may be incompatibilities between the Haxe and HashLink versions. Therefore, I will immediately make a reservation that when writing this material, I used the following versions of Haxe, HashLink and libraries:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Haxe 4.0.0-preview.4</span><br><span class="line">HashLink 1.7</span><br><span class="line">heaps 1.3.0</span><br><span class="line">hlsdl 1.7.0</span><br><span class="line">hldx 1.7.0</span><br><span class="line">hlopenal 1.5.0 (the audio library that hlsdl and hldx depend on)</span><br></pre></td></tr></table></figure><p>After downloading and unpacking HashLink, you need to add the path to its folder to the path system variable (otherwise you won’t be able to run hl files in VS Code). If you installed on Mac or Linux, then you’re good to go, no PATH modification necessary.</p><p>Heaps can be installed either from haxelib:</p><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">haxelib install heaps</span><br></pre></td></tr></table></figure><p>Or install from the git version of the library:</p><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">haxelib git heaps https:<span class="type"></span>//github.com/HeapsIO/heaps.git</span><br></pre></td></tr></table></figure><p>A set of samples is distributed with Heaps (see the samples folder). It is highly recommended that you familiarize yourself with them for a better understanding of the library.</p><p>In this article, we will be using VS Code as an editor.</p><p>To work with Haxe in VS Code, use the “Haxe Extension Pack”:</p><p><img src="/images/heaps_05.png" class="lazyload" data-srcset="/images/heaps_05.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt=""></p><h2 id="Setting-Up-a-Project"><a href="#Setting-Up-a-Project" class="headerlink" title="Setting Up a Project"></a>Setting Up a Project</h2><p>Launch VS Code, open the project folder you created (create one if you didn’t) (File -&gt; Open folder). Create two folders: <code>src</code> and <code>out</code> at the top-level.</p><p>Here are a few files you need to create:</p><ol><li><em>Main.hx</em> - <strong>Place this inside the <code>src</code> folder.</strong><br>The main (and only in our case) project class inherited from hxd.App (the base class for Heaps applications):</li></ol><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Main</span> <span class="keyword"><span class="keyword">extends</span> <span class="type">hxd</span></span>.<span class="title">App</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">        <span class="keyword">new</span> <span class="type">Main</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><em>Note the capitalization difference for <code>Main</code> and <code>main</code>. Haxe, like any other language, is case-sensitive.</em></p><ol start="2"><li><em>build.hxml</em> - <strong>Place this outside the <code>src</code> folder, at top level.</strong><br>The file with settings for project compilation. Set the following parameters:</li></ol><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># imports the heaps library</span></span><br><span class="line">-lib heaps</span><br><span class="line"><span class="meta"># uses SDL (Simple DirectMedia Layer), but <span class="meta-keyword">if</span> you're on Windows, feel free to change it to "hldx"</span></span><br><span class="line">-lib hlsdl</span><br><span class="line"><span class="meta"># set the output path</span></span><br><span class="line">-hl out/hashlink/main.hl</span><br><span class="line"><span class="meta"># set window size</span></span><br><span class="line">-D windowSize=<span class="number">1366</span>x768</span><br><span class="line"><span class="meta"># set window title</span></span><br><span class="line">-D windowTitle=Test App</span><br><span class="line"><span class="meta"># set path where main file resides</span></span><br><span class="line">--class-path src</span><br><span class="line"><span class="meta"># set main class name</span></span><br><span class="line">-main Main</span><br></pre></td></tr></table></figure><p>After creating these files, this should be your file structure:</p><p>projectName<br>—out<br>—src<br>——<em>Main.hx</em><br>—<em>build.hxml</em></p><p>Make sure the structure looks like this, then press Ctrl-Shift-B. A dialog should pop up to select a task. Select “haxe: build.hxml”, and compile the project.</p><p>After that, the file main.hl should appear in the file tree inside the <code>out/hashlink</code> folder.</p><p>If this does not happen, then this most likely means that some process is frozen and you need to restart VS Code, the easiest way to do this is by calling the “Reload window” command - for this we call the command panel (Ctrl + Shift + P), type “reload”, and press enter.</p><p>Also, if your autocomplete or code jumps stop working, then most likely you just need to restart the Language Server - an auxiliary process that calls on the Haxe compiler to perform these tasks. The Language Server can also be restarted through the command bar (Ctrl + Shift + P) with the command “Haxe: Restart Language Server”.</p><p>Now let’s try to automate the launch of our hl file, and for this we will create a corresponding task in the project. Press F5 and select HashLink as the environment:</p><p><img src="/images/heaps_06.png" class="lazyload" data-srcset="/images/heaps_06.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt=""></p><p>In the generated code, you need to correct the name of the hxml file if it does not say <code>build.hxml</code>. Rename it to <code>build.hxml</code> otherwise.</p><p>Now we need to set up the default build task (Tasks -&gt; Set up default build task …) by choosing game.hxml as the task:</p><p><img src="/images/heaps_07.png" class="lazyload" data-srcset="/images/heaps_07.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt=""></p><p>In the generated task, you need to give it the name “Build” by adding the “label” field with the appropriate value (since a task with this name is searched for and launched before launching the application - it is set in launch.json by the “preLaunchTask” field):</p><p><img src="/images/heaps_08.png" class="lazyload" data-srcset="/images/heaps_08.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt=""></p><p>Having configured all the tasks, we can finally launch the application by pressing F5 - an empty window with a black background will open.</p><p>Besides the fact that VS Code has support for the Haxe syntax, working with Heaps and HashLink in VS Code is also convenient because the HashLink debugger is included in the extension package.</p><h3 id="Haxe-Program-Structure"><a href="#Haxe-Program-Structure" class="headerlink" title="Haxe Program Structure"></a>Haxe Program Structure</h3><p><em>Personal Note</em></p><p>If you’ve worked with other game frameworks, you may be familiar with the <code>init()</code> and <code>update()</code> methods. </p><p><code>init()</code> is what is called when the program starts up, and only then. It is never called after, so this function is where you create all your variables and initialize other classes.</p><p><code>update()</code> is called multiple times a second (anywhere from 100-500), so this is where your main game logic goes. It basically functions as a while loop, keeping the game running, updating sprites and delta time, detecting events, etc.</p><h3 id="Adding-Visuals"><a href="#Adding-Visuals" class="headerlink" title="Adding Visuals"></a>Adding Visuals</h3><p>Let’s now add visual objects to the scene. Let’s add a 2d image - a Bitmap object whose constructor takes 2 parameters: tile and parent.</p><p><code>Tile</code> describes a certain area of ​​the <code>Texture</code> (many tiles can be created from one texture). In this example, we will create a tile programmatically - from a texture filled with red. Let’s add our object to a 2d scene, which is automatically created by the engine - s2d (it is a property of the main class - h2d.App, beside it, a 3d scene is created in the application - s3d):</p><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">function</span> <span class="title">init</span></span>() &#123;</span><br><span class="line">    <span class="built_in">trace</span>(<span class="string">"Hello World!"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> b = <span class="keyword">new</span> <span class="type">h2d</span>.Bitmap(h2d.Tile.fromColor(<span class="number">0xff0000</span>, <span class="number">60</span>, <span class="number">60</span>), s2d);</span><br><span class="line">    b.x = <span class="number">50</span>;</span><br><span class="line">    b.y = <span class="number">100</span>;</span><br><span class="line"></span><br><span class="line">    b.tile = b.tile.center();</span><br><span class="line">    b.rotation = Math.PI / <span class="number">4</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>In the above code, we are centering the tile (give it an anchor point). This way all transformations of the object on the screen will be calculated relative to the center of the tile. If this method is not called, then the tile will be transformed relative to its top left point. We also rotate the tile, and the rotation is given in radians.</p><p>You can also center the tile using the dx and dy properties of the tile.</p><h4 id="Coloring"><a href="#Coloring" class="headerlink" title="Coloring"></a>Coloring</h4><p>Objects in a 2D scene have many properties similar to those of DisplayObject in Flash, for example, color transformations can be configured as follows:</p><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">b.color.<span class="keyword">set</span>(<span class="number">1.0</span>, <span class="number">0.0</span>, <span class="number">0.0</span>);</span><br><span class="line"></span><br><span class="line">b.colorAdd = <span class="keyword">new</span> <span class="type">h3d</span>.Vector(<span class="number">0.0</span>, <span class="number">0.0</span>, <span class="number">1.0</span>, <span class="number">0.0</span>);</span><br><span class="line">b.adjustColor(&#123;hue: <span class="type">Math</span>.random()&#125;);</span><br><span class="line"></span><br><span class="line">b.colorKey = <span class="number">0xffffffff</span>;</span><br></pre></td></tr></table></figure><p>Let’s add dynamics - let our object change its position over time. To do this, h2d.App has an update (dt: Float) method that I mentioned earlier that’s called every frame. Let’s override it:</p><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">function</span> <span class="title">update</span></span>(dt:<span class="type">Float</span>) &#123;</span><br><span class="line">    b.rotation += <span class="number">0.01</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Now, if we compile the example (Ctrl-Shift-B, then f5), we will see a red rotating square.</p><h4 id="Interaction-and-User-Events"><a href="#Interaction-and-User-Events" class="headerlink" title="Interaction and User Events"></a>Interaction and User Events</h4><p>Let’s now look at how Heaps handles user input events.</p><p>In Heaps, unlike Flash, objects in the scene cannot themselves handle mouse events. For this, objects of type h2d.Interactive are created, which are added as child objects to the scene. Add the following code at the end of the <code>init()</code> method:</p><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> i = <span class="keyword">new</span> <span class="type">h2d</span>.Interactive(b.tile.width, b.tile.height, b);</span><br><span class="line"></span><br><span class="line">i.x = <span class="number">-0.5</span> * b.tile.width;</span><br><span class="line">i.y = <span class="number">-0.5</span> * b.tile.height;</span><br><span class="line"></span><br><span class="line">i.onOver = <span class="function"><span class="keyword">function</span></span>(event : <span class="type">hxd</span>.Event) &#123;</span><br><span class="line">    b.alpha = <span class="number">0.5</span>;</span><br><span class="line">&#125; </span><br><span class="line">i.onOut = <span class="function"><span class="keyword">function</span></span>(event : <span class="type">hxd</span>.Event) &#123;</span><br><span class="line">    b.alpha = <span class="number">1.0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>As you can see, the interactive object takes a rectangular area to detect mouse input. The event detection is a handler system, with the function assigned to the event being called every time the mouse activates that event.</p><p>Now, when you hover the mouse over the red square, it will become semi-transparent, and when you move the mouse out, it will become opaque again.</p><p>In order to override the behavior of an Interactive object (the area in which mouse events are triggered), you can override its onCheck() method.<br>Also in Heaps, instead of a rectangular validation area, you can set it to an ellipse-shaped area; for this, the Interactive object has a boolean property isEllipse.</p><p>Handling keyboard button clicks:</p><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">function</span> <span class="title">update</span></span>(dt:<span class="type">Float</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (hxd.Key.isDown(hxd.Key.RIGHT)) &#123;</span><br><span class="line">        g.x++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (hxd.Key.isDown(hxd.Key.LEFT)) &#123;</span><br><span class="line">        g.x--;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>To organize work with different tasks, the hxd.WaitEvent class has been added to Heaps, which executes the function passed to it until it returns true. Also, WaitEvent has several predefined functions, for example, for deferred method invocation:</p><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> w:<span class="type">hxd</span>.WaitEvent;</span><br><span class="line"></span><br><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">function</span> <span class="title">init</span></span>() &#123;</span><br><span class="line">    w = <span class="keyword">new</span> <span class="type">hxd</span>.WaitEvent();</span><br><span class="line">    w.wait(<span class="number">2</span>, <span class="function"><span class="keyword">function</span></span>() &#123;</span><br><span class="line">        <span class="built_in">trace</span>(<span class="string">"Kept you waiting, huh?"</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">    w.add(everyFrameRoutine);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">function</span> <span class="title">update</span></span>(dt:<span class="type">Float</span>) &#123;</span><br><span class="line">    w.update(dt);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">everyFrameRoutine</span></span>(dt:<span class="type">Float</span>):<span class="type">Bool </span>&#123;</span><br><span class="line">    <span class="built_in">trace</span>(<span class="string">"everyFrameRoutine"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Images-and-Textures"><a href="#Images-and-Textures" class="headerlink" title="Images and Textures"></a>Images and Textures</h4><p>Let’s try to use an image as a texture.</p><p>Add a folder “res” to the project (by default, a folder with this name is used as a resource store, but if necessary, the folder name can be redefined in the project by setting the resourcesPath compilation flag as such: <code>-D resourcesPath=assets/</code>).</p><p>This should be the folder structure of the project now, after adding <a href="/images/logo.png">this image</a> to the assets folder:</p><p>projectName<br>—assets<br>——<em>logo.png</em><br>—out<br>——hashlink<br>———<em>main.hl</em><br>—src<br>——<em>Main.hx</em><br>—<em>build.hxml</em></p><p>Note how the above structure omits the <code>.vscode</code> folder, this is intentional, do <strong>not</strong> delete that folder.</p><p>Now, change this line of code:</p><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">b = <span class="keyword">new</span> <span class="type">h2d</span>.Bitmap(h2d.Tile.fromColor(<span class="number">0xff0000</span>, <span class="number">60</span>, <span class="number">60</span>), s2d);</span><br></pre></td></tr></table></figure><p>To this:</p><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">b = <span class="keyword">new</span> <span class="type">h2d</span>.Bitmap(hxd.Res.logo.toTile(), s2d);</span><br></pre></td></tr></table></figure><p>In the above sample, we are calling hxd (the underlying heaps library) to access the resources folder designated, find the PNG with the name “logo”, and convert it to a tile.</p><h4 id="Resource-Management-System-Backend"><a href="#Resource-Management-System-Backend" class="headerlink" title="Resource Management System Backend"></a>Resource Management System Backend</h4><p>Due to the fact that the resource management system is based on macros, the names of files with resources do not need to be specified as strings - they become fields of the hxd.Res class, which avoids typos in file names (messages about such errors are displayed at the compilation stage of the application).</p><p>In addition, based on file extensions, the resource system independently determines the type of resource (for example, jpg and png are processed as images).</p><p>The table of correspondence between file extensions and resource types is defined in the <code>hxd.res.Config</code> class and can be changed because is a public variable:</p><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">var</span> extensions = [</span><br><span class="line">    <span class="string">"jpg,png,jpeg,gif,tga"</span> =&gt; <span class="string">"hxd.res.Image"</span>,</span><br><span class="line">    <span class="string">"fbx,hmd"</span> =&gt; <span class="string">"hxd.res.Model"</span>,</span><br><span class="line">    <span class="string">"ttf"</span> =&gt; <span class="string">"hxd.res.Font"</span>,</span><br><span class="line">    <span class="string">"fnt"</span> =&gt; <span class="string">"hxd.res.BitmapFont"</span>,</span><br><span class="line">    <span class="string">"wav,mp3,ogg"</span> =&gt; <span class="string">"hxd.res.Sound"</span>,</span><br><span class="line">    <span class="string">"tmx"</span> =&gt; <span class="string">"hxd.res.TiledMap"</span>,</span><br><span class="line">    <span class="string">"atlas"</span> =&gt; <span class="string">"hxd.res.Atlas"</span>,</span><br><span class="line">    <span class="string">"grd"</span> =&gt; <span class="string">"hxd.res.Gradients"</span>,</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">if</span> hide</span></span><br><span class="line">    <span class="string">"prefab,fx,l3d"</span> =&gt; <span class="string">"hxd.res.Prefab"</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">end</span></span></span><br><span class="line">];</span><br></pre></td></tr></table></figure><p>In an extreme case, resources can be loaded by file name, but the typing of resources is lost and you need to independently convert the resulting resource to its type:</p><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hxd.Res.load(<span class="string">"logo.png"</span>).toImage().toTile();</span><br></pre></td></tr></table></figure><p>You can also create a resource from a byte array and cast it to the required type:</p><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hxd.res.Any.fromBytes(...);</span><br></pre></td></tr></table></figure><p>But in order for the texture to actually load, it is necessary to initialize the resource system. This is done before calling the application constructor at the beginning of the app. Place the following line of code before calling <code>new Main()</code> in the <code>main()</code> method, and replace the BitMap declaration:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">class Main extends hxd.App &#123;</span><br><span class="line">    </span><br><span class="line">    var b:h2d.Bitmap;</span><br><span class="line">    </span><br><span class="line">    static function main() &#123;</span><br><span class="line">        hxd.Res.initLocal();</span><br><span class="line">        new Game();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    override function init() &#123;</span><br><span class="line">        b &#x3D; new h2d.Bitmap(hxd.Res.load(&quot;haxeLogo.png&quot;).toImage().toTile(), s2d);</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>In this example, we are calling the <code>Res.initLocal()</code> method, which means that resources will be read from the local disk system as separate files. In addition to this method, methods are available:</p><p><code>initEmbed()</code> - all resources will be embedded in the application file;</p><p><code>initPak()</code> - resources will be packed into pak files (resource archives that can be grouped according to some attribute, for example, resources of a certain game level).</p><p>In addition, you can independently determine how resources will be loaded (for example, over the network). Heaps implements a live reload mechanism for resources, which is activated by the pipeline (before initializing the resource system):</p><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hxd.res.Resource.LIVE_UPDATE = <span class="literal">true</span>;</span><br></pre></td></tr></table></figure><p>And to process resource changes, you need to assign a callback, which will be called at the same time:</p><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hxd.Res.logo.entry.watch(changeCallback);</span><br></pre></td></tr></table></figure><p>Here the entry property of <code>hxd.Res.logo</code> is an object of the virtual file system, with which the resource system works as an abstraction. Entry has its own interface, with which you can determine if entry is a folder or file, read its bytes, etc.</p><p>It should also be said that in Heaps unused resources are automatically removed from memory, but there are also manual methods for destroying them, for example, tiles have a <code>dispose()</code> method that removes the texture it uses from memory.</p><h4 id="Text-Processing-and-Display"><a href="#Text-Processing-and-Display" class="headerlink" title="Text Processing and Display"></a>Text Processing and Display</h4><p>Here are a few more important classes based around text processing:</p><ul><li>For buttons and other “stretching” elements (using 9 slice), Heaps has the <code>h2d.ScaleGrid</code> class.</li><li>The <code>h2d.Flow</code> component can be used for layout elements.</li><li>Text rendering can be done either using the <code>h2d.Text</code> class, or using <code>h2d.HtmlText</code>, which supports markup using html tags.</li><li>An inputable text field is implemented in the <code>h2d.TextInput</code> class.</li></ul><p>In these classes, BitMap fonts are used as fonts, which can be prepared, for example, in the bmfont program (on the net you can find many of its counterparts with a wide range of capabilities). Also, if the target platform is Flash, JS or Lime (not officially supported), then BitMap fonts can be generated programmatically from vector using the <code>hxd.res.FontBuilder</code> class:</p><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fnt = hxd.res.FontBuilder.getFont(<span class="string">"Verdana"</span>, <span class="number">24</span>);</span><br></pre></td></tr></table></figure><p>Here’s the simplest example of using the h2d.Text class (place this in the <code>init()</code> function):</p><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> t = <span class="keyword">new</span> <span class="type">h2d</span>.Text(hxd.res.DefaultFont.<span class="keyword">get</span>(), s2d);</span><br><span class="line">t.scale(<span class="number">10</span>);</span><br><span class="line"></span><br><span class="line">t.text = <span class="string">"Hello Haxe"</span>;</span><br></pre></td></tr></table></figure><p>This created a <code>Text</code> object with the default font, attaches it to the 2D scene, scales it up by 10, and sets the text. Building/running the project again shows the text in the window.</p><p><code>h2d.HtmlText</code> inherits from <code>h2d.Text</code> and working with it is no different:</p><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> t = <span class="keyword">new</span> <span class="type">h2d</span>.HtmlText(hxd.res.DefaultFont.<span class="keyword">get</span>(), s2d);</span><br><span class="line">t.scale(<span class="number">10</span>);</span><br><span class="line"></span><br><span class="line">t.text = <span class="string">"Hello &lt;font color='#ff0000'&gt;Haxe&lt;/font&gt;"</span>;</span><br></pre></td></tr></table></figure><p><code>h2d.InputText</code> adds the ability to handle text input from the keyboard, as well as the ability to get information about the selected text fragment (using the cursorIndex and selectionRange properties):</p><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> t = <span class="keyword">new</span> <span class="type">h2d</span>.TextInput(hxd.res.DefaultFont.<span class="keyword">get</span>(), s2d);</span><br><span class="line">t.scale(<span class="number">10</span>);</span><br><span class="line"></span><br><span class="line">t.text = <span class="string">"Input Here"</span>;</span><br></pre></td></tr></table></figure><h4 id="Tile-Batching"><a href="#Tile-Batching" class="headerlink" title="Tile Batching"></a>Tile Batching</h4><p>Next up, tile batching! There are 2 classes for batching tiles in Heaps:</p><ul><li><em>h2d.TileGroup</em> - for static groups whose elements do not change their relative position</li><li><em>h2d.SpriteBatch</em> - for dynamic groups</li></ul><p>An example of using h2d.TileGroup:</p><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> g:<span class="type">h2d</span>.TileGroup;</span><br><span class="line"></span><br><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">function</span> <span class="title">init</span></span>() &#123;</span><br><span class="line">    <span class="keyword">var</span> tiles = hxd.Res.logo.toTile().gridFlatten(<span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    g = <span class="keyword">new</span> <span class="type">h2d</span>.TileGroup(tiles[<span class="number">0</span>], s2d);</span><br><span class="line">    g.blendMode = None;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (i <span class="keyword">in</span> <span class="number">0.</span>.<span class="number">.1000</span>) &#123;</span><br><span class="line">        g.add(Std.random(s2d.width), Std.random(s2d.height), tiles[i % tiles.length]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">function</span> <span class="title">update</span></span>(dt:<span class="type">Float</span>) &#123;</span><br><span class="line">    g.rotation += <span class="number">0.01</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Since the TileGroup class is optimized for rendering static elements, transformations of the entire group cost almost nothing in terms of performance! That is, you can change the position, scale, and rotation of the group without slowing down the application speed, no matter how many elements there are.</p><p>Consider creating simple 2d animations using the h2d.Anim class:</p><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> animationSpeed = <span class="number">15</span>;</span><br><span class="line">b = <span class="keyword">new</span> <span class="type">h2d</span>.Anim(hxd.Res.logo.toTile().split(<span class="number">10</span>, <span class="literal">false</span>), animationSpeed, s2d);</span><br></pre></td></tr></table></figure><p>Here we split the texture into 10 horizontal frames, set the animation speed and add an animated sprite to the scene.</p><p>Of course, for an animated sprite, you can manually change the animation speed, set the current frame, pause the animation, etc. (in general, do whatever is expected of animation):</p><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">b.currentFrame = <span class="number">1</span>;</span><br><span class="line">b.pause = <span class="literal">true</span>;</span><br><span class="line">b.speed = <span class="number">10</span>;</span><br></pre></td></tr></table></figure><h4 id="Shape-Rendering-Geometric-Primitives"><a href="#Shape-Rendering-Geometric-Primitives" class="headerlink" title="Shape Rendering / Geometric Primitives"></a>Shape Rendering / Geometric Primitives</h4><p>To draw geometric primitives in Heaps, such as shapes, objects of the <code>h2d.Graphics</code> type are used (there is also <code>h3d.scene.Graphics</code>, which works with a 3D scene), which are similar to <code>flash.display.Graphics</code> in Flash, but at the same time are an element of the scene, and not a property of sprites:</p><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> g:<span class="type">h2d</span>.Graphics;</span><br><span class="line"></span><br><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">function</span> <span class="title">init</span></span>() &#123;</span><br><span class="line">    g = <span class="keyword">new</span> <span class="type">h2d</span>.Graphics(s2d);</span><br><span class="line"></span><br><span class="line">    g.beginFill(<span class="number">0xff00ff</span>, <span class="number">0.5</span>);</span><br><span class="line">    g.drawCircle(<span class="number">150</span>, <span class="number">150</span>, <span class="number">100</span>);</span><br><span class="line">    g.endFill()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>At the same time, unlike OpenFL (another Haxe game development library), all primitives are rendered entirely by means of the GPU, without consuming additional memory, and are also stored in a buffer (that is, each frame is not recalculated).</p><h1 id="Done"><a href="#Done" class="headerlink" title="Done!"></a>Done!</h1><p>Hopefully after going through this guide, you’ve become more acquainted and proficient with 2D Heaps.io. With a library like this, understanding the documentation can be critical to your game, and I hope I’ve cleared some things up. </p><p>Have fun with game development! Feel free to share any cool projects with me at <a href="mailto:bansalrohan18@gmail.com">bansalrohan18@gmail.com</a>.</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;em&gt;30 minutes to 1 hour read time. Get cozy with ur laptop or PC!&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;This post is meant for people who have experience in the &lt;</summary>
      
    
    
    
    
    <category term="game_development, heaps.io, haxe, 2d" scheme="http://blog.rohanbansal.me/tags/game-development-heaps-io-haxe-2d/"/>
    
  </entry>
  
  <entry>
    <title>My Experience Theming Windows 10</title>
    <link href="http://blog.rohanbansal.me/2020/07/02/My-Experience-Theming-Windows-10/"/>
    <id>http://blog.rohanbansal.me/2020/07/02/My-Experience-Theming-Windows-10/</id>
    <published>2020-07-03T06:06:41.000Z</published>
    <updated>2020-09-21T18:14:33.968Z</updated>
    
    <content type="html"><![CDATA[<p>I recently dove into the world of <strong>Windows 10 theming</strong>, and thought I should share my experience. I am running the following at the time of writing:</p><ul><li>Windows 10 (dual boot with Linux)</li><li>Version 1909 </li><li>Build #18363.900</li></ul><p>Compared to Linux, Windows has been restricted in many aspects, including customization. You can only change a few desktop tones and colors, and the rest is hidden behind a registry which requires a lot of tweaking to get to. Most of this can’t be done by hand, because Windows designed that part to only be done by it’s own programs, and is therefore very hard to read.</p><p>There also aren’t that many tutorials out there on how to theme Windows with a patcher, so you can use this post as a torch! I’ll include links to everything so you can check them out yourself.</p><h3 id="Quick-Word-of-Caution"><a href="#Quick-Word-of-Caution" class="headerlink" title="Quick Word of Caution"></a>Quick Word of Caution</h3><p>Theming Windows is fun and can have a great end result, but I suggest creating a <a href="https://www.howtogeek.com/howto/windows-vista/using-windows-vista-system-restore/" target="_blank" rel="noopener">system restore point</a> before continuing. If anything goes wrong, you can always restore to that and have nothing to worry about.</p><h1 id="How-I-Got-Started"><a href="#How-I-Got-Started" class="headerlink" title="How I Got Started"></a>How I Got Started</h1><p>I stumbled upon <a href="https://www.deviantart.com/niivu/art/ko-Z-for-Windows-10-842117943" target="_blank" rel="noopener">this post</a> while browsing DeviantArt one day! The user who posted that theme (<a href="https://www.deviantart.com/niivu" target="_blank" rel="noopener">niivu</a>) has created a few different Windows themes, and that’s how I learned what tools to use and where.</p><ul><li><strong>UltraUXThemePatcher</strong></li><li><strong>OldNewExplorer</strong></li><li><strong>StartIsBack</strong></li><li><strong>WinAeroTweaker</strong></li></ul><p>The tools above are recommended in various places, and I’ll tell you what I think of each.</p><h3 id="UltraUXThemePatcher"><a href="#UltraUXThemePatcher" class="headerlink" title="UltraUXThemePatcher"></a>UltraUXThemePatcher</h3><p><em>link: <a href="http://www.syssel.net/hoefs/software_uxtheme.php?lang=en" target="_blank" rel="noopener">ultrauxthemepatcher</a></em></p><p>A UX patcher in Windows is very similar to the GNOME tweak tool in Debian Linux distros, except it specializes in breaking open the theming capabilities of Windows. Many of the guides online for Windows theming say to use this patcher, but DO NOT USE IT. </p><p><a href="https://github.com/namazso/SecureUxTheme" target="_blank" rel="noopener">SecureUXThemePatcher</a> is a better patcher that allows you to theme without modifying system files. It also fixes a few bugs found in UltraUXThemePatcher, such as a few colors reverting to their defaults randomly.</p><h4 id="How-I-Used-It"><a href="#How-I-Used-It" class="headerlink" title="How I Used It"></a>How I Used It</h4><ul><li>Patched the Nord theme onto Windows</li></ul><h3 id="OldNewExplorer"><a href="#OldNewExplorer" class="headerlink" title="OldNewExplorer"></a>OldNewExplorer</h3><p><em>link: <a href="https://msfn.org/board/topic/170375-oldnewexplorer-119/" target="_blank" rel="noopener">oldnewexplorer</a></em></p><p>OldNewExplorer is a tweak for Windows that makes the file explorer extremely customizable. Here’s a list of the things it can do:</p><ul><li>Restore device/drive grouping (moving things from devices/drives section)</li><li>Remove unused folders that were added in Windows 8 that no one uses</li><li>Remove the ribbon (most useful!)</li><li>Restore the details pane at the bottom of the explorer</li><li>Improve styling capabilities</li></ul><h4 id="How-I-Used-It-1"><a href="#How-I-Used-It-1" class="headerlink" title="How I Used It"></a>How I Used It</h4><ul><li>The ribbon remover was particularly unhelpful, it didn’t get rid of the ribbon for me. I used <a href="https://winaero.com/download.php?view.18" target="_blank" rel="noopener">this tool</a> instead.</li><li>Removed the quick access folder</li><li>Reordered drive groups</li></ul><h3 id="StartIsBack"><a href="#StartIsBack" class="headerlink" title="StartIsBack"></a>StartIsBack</h3><p><em>link: <a href="http://startisback.com/" target="_blank" rel="noopener">startisback</a></em></p><p>After glancing at the site above, you may be thinking <em>ewww thats old, Windows 10 start menu was better</em>, you’re partially right. Using StartIsBack by itself without theming anything does not look great at all. However, with some styling changes, it can look better than the Windows 10 one!</p><h4 id="How-I-Used-It-2"><a href="#How-I-Used-It-2" class="headerlink" title="How I Used It"></a>How I Used It</h4><ul><li>Modified the original Windows 10 start menu into a <a href="https://www.nordtheme.com/" target="_blank" rel="noopener">Nord</a> theme</li><li>Minimalized the dock</li></ul><h3 id="WinAeroTweaker"><a href="#WinAeroTweaker" class="headerlink" title="WinAeroTweaker"></a>WinAeroTweaker</h3><p><em>link: <a href="https://winaero.com/comment.php?comment.news.1836" target="_blank" rel="noopener">winaerotweaker</a></em></p><p>WinAeroTweaker is a small application that is actually pretty powerful. It contains a huge variety of tweaks that can change the Windows experience drastically.</p><h4 id="How-I-Used-It-3"><a href="#How-I-Used-It-3" class="headerlink" title="How I Used It"></a>How I Used It</h4><ul><li>Shrinking taskbar size</li><li>Reordering taskbar widgets</li><li>Resizing desktop shortcuts</li></ul><h1 id="Tutorial-Patching-a-Nord-theme"><a href="#Tutorial-Patching-a-Nord-theme" class="headerlink" title="Tutorial: Patching a Nord theme"></a>Tutorial: Patching a Nord theme</h1><p>This following section will walk you through changing the Windows scheme to match <a href="nordtheme.com">this</a>. We will change the start menu, the file explorer, system icons, system theme, taskbar, and even music player!</p><p><em>Stay tuned for this section, currently WIP</em></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;I recently dove into the world of &lt;strong&gt;Windows 10 theming&lt;/strong&gt;, and thought I should share my experience. I am running the followi</summary>
      
    
    
    
    
    <category term="windows, ricing, theme, uxpatcher" scheme="http://blog.rohanbansal.me/tags/windows-ricing-theme-uxpatcher/"/>
    
  </entry>
  
  <entry>
    <title>Compiling Aseprite for Linux</title>
    <link href="http://blog.rohanbansal.me/2020/05/24/Compiling-Aseprite-for-Linux/"/>
    <id>http://blog.rohanbansal.me/2020/05/24/Compiling-Aseprite-for-Linux/</id>
    <published>2020-05-25T06:15:48.000Z</published>
    <updated>2020-09-21T18:15:05.291Z</updated>
    
    <content type="html"><![CDATA[<p>This post details my experience compiling Aseprite (the most popular pixelart editor) for Ubuntu. It was poorly documented, so I aim to be as concise as possible so those reading have no trouble. </p><p>That being said, this guide is for compiling Aseprite on Linux, not Windows. Windows has a few extra steps, and I’ll link a handy guide <a href="https://www.youtube.com/watch?v=si7N0GeqOH8" target="_blank" rel="noopener">here</a>.</p><h1 id="Compiling-Tools"><a href="#Compiling-Tools" class="headerlink" title="Compiling Tools"></a>Compiling Tools</h1><p>On Linux, Aseprite requires the following packages:</p><p><code>g++ cmake ninja-build libx11-dev libxcursor-dev libxi-dev libgl1-mesa-dev libfontconfig1-dev</code></p><p>Install them with your package manager of choice. For example, on Ubuntu:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install -y g++ cmake ninja-build libx11-dev libxcursor-dev libxi-dev libgl1-mesa-dev libfontconfig1-dev</span><br></pre></td></tr></table></figure><p>You also need CMake version 3.14 or higher. To check, run:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmake --version</span><br></pre></td></tr></table></figure><p>Next, the Ninja build system is needed. Here are a few installation methods by distro:</p><p>Arch: <code>pacman -S ninja</code></p><p>Debian/Ubuntu: <code>apt-get install ninja-build</code></p><p>Fedora: <code>dnf install ninja-build</code></p><h2 id="Skia"><a href="#Skia" class="headerlink" title="Skia"></a>Skia</h2><p>Last but not least, you will need both depot_tools and the Skia graphics library. There are two methods, compiling Skia from source or downloading a prebuilt binary.</p><h3 id="Compiling-From-Source"><a href="#Compiling-From-Source" class="headerlink" title="Compiling From Source"></a>Compiling From Source</h3><p>The following script creates a <code>dep</code> folder in your root directory to store both packages in. Note that compiling Skia will take a while, depending on the machine.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mkdir <span class="variable">$HOME</span>/deps</span><br><span class="line"><span class="built_in">cd</span> <span class="variable">$HOME</span>/deps</span><br><span class="line">git <span class="built_in">clone</span> https://chromium.googlesource.com/chromium/tools/depot_tools.git</span><br><span class="line">git <span class="built_in">clone</span> -b aseprite-m81 https://github.com/aseprite/skia.git</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="string">"<span class="variable">$&#123;PWD&#125;</span>/depot_tools:<span class="variable">$&#123;PATH&#125;</span>"</span></span><br><span class="line"><span class="built_in">cd</span> skia</span><br><span class="line">python tools/git-sync-deps</span><br><span class="line">gn gen out/Release-x64 --args=<span class="string">"is_debug=false is_official_build=true skia_use_system_expat=false skia_use_system_icu=false skia_use_system_libjpeg_turbo=false skia_use_system_libpng=false skia_use_system_libwebp=false skia_use_system_zlib=false"</span></span><br><span class="line">ninja -C out/Release-x64 skia modules</span><br></pre></td></tr></table></figure><h3 id="Prebuilt-Binary"><a href="#Prebuilt-Binary" class="headerlink" title="Prebuilt Binary"></a>Prebuilt Binary</h3><p>Before downloading anything, run: </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir ~/deps ~/deps/skia</span><br></pre></td></tr></table></figure><p>This ensures the binary is easily accessible by the aseprite install script detailed later in the article. Feel free to change the path, but remember to change the directory in the install script as well.</p><p>Then, go ahead and download the <a href="https://github.com/aseprite/skia/releases" target="_blank" rel="noopener">release</a>. Make sure the branch is Skia-m81. After downloading, extract the contents into the <code>deps/skia</code> directory. </p><h1 id="Compiling-Aseprite"><a href="#Compiling-Aseprite" class="headerlink" title="Compiling Aseprite"></a>Compiling Aseprite</h1><p>Now, you have to pull the official GitHub repository for Aseprite. </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> --recursive https://github.com/aseprite/aseprite.git</span><br></pre></td></tr></table></figure><p>The line above will create a folder called <code>aseprite</code> in the directory you ran the command in. I recommend creating it in your root directory, but it shouldn’t matter where.</p><p>For future reference, to update Aseprite, run the following commands:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> aseprite</span><br><span class="line">git pull</span><br><span class="line">git submodule update --init --recursive</span><br></pre></td></tr></table></figure><p>Next, you have to create a build directory to store compile output and the generated Aseprite binary. Modify the first command below if you cloned Aseprite in a different location.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> ~/aseprite</span><br><span class="line">mkdir build</span><br><span class="line"><span class="built_in">cd</span> build</span><br></pre></td></tr></table></figure><p>There are only a few more commands to get Aseprite working! Next up is compilation with CMake. Remember, if you decided to install Skia in another location, replace <code>$HOME/deps/skia</code> with that path.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cmake \</span><br><span class="line">  -DCMAKE_BUILD_TYPE=RelWithDebInfo \</span><br><span class="line">  -DLAF_BACKEND=skia \</span><br><span class="line">  -DSKIA_DIR=<span class="variable">$HOME</span>/deps/skia \</span><br><span class="line">  -DSKIA_LIBRARY_DIR=<span class="variable">$HOME</span>/deps/skia/out/Release-x64 \</span><br><span class="line">  -G Ninja \</span><br><span class="line">  ..</span><br></pre></td></tr></table></figure><p>Finally, run this to compile the Aseprite binary:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ninja aseprite</span><br></pre></td></tr></table></figure><p>There you have it! After the compilation finishes, navigate to <code>aseprite/build/bin</code> and you should see the aseprite file. You can run it in terminal with:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./aseprite</span><br></pre></td></tr></table></figure><p>However, for ease of access, you may want to launch it from the applications menu or the dock. The next section explains the process of creating a desktop file to do this.</p><h1 id="Installing-Aseprite-Globally"><a href="#Installing-Aseprite-Globally" class="headerlink" title="Installing Aseprite Globally"></a>Installing Aseprite Globally</h1><p>To install Aseprite system-wide, you need to make use of the .desktop file format. For example, this is my entry for Aseprite, installed in <code>/usr/share/applications</code>:</p><p>aseprite.desktop</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[Desktop Entry]</span><br><span class="line">X-AppInstall-Package=aseprite</span><br><span class="line">X-AppInstall-Popcon=0</span><br><span class="line">X-AppInstall-Section=universe</span><br><span class="line"></span><br><span class="line">Name=ASEPRITE</span><br><span class="line">Comment=Sprite Editor</span><br><span class="line">Exec=aseprite</span><br><span class="line">Icon=aseprite</span><br><span class="line">Terminal=<span class="literal">false</span></span><br><span class="line">Type=Application</span><br><span class="line">Categories=Graphics;2DGraphics;RasterGraphics;</span><br><span class="line"></span><br><span class="line">X-Ubuntu-Gettext-Domain=app-install-data</span><br></pre></td></tr></table></figure><p>As arguments for this file differ based on distribution, we’ll use the <code>alacarte</code> package. This program is available in most package repositories, like the AUR and apt. </p><p>To install on Ubuntu, run:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install -y alacarte</span><br></pre></td></tr></table></figure><p>After installation, run the command <code>alacarte</code> in a terminal, and a GUI should pop up. In the left sidebar, click “Graphics”. </p><p>From here, the “New Item” button in the right sidebar should be clickable. A new GUI should pop up, and you can fill in details such as the name of the program (Aseprite), and the command to be run. </p><p>For the command, click “Browse”, navigate to <code>~/aseprite/build/bin/</code> (or wherever you installed it), and click the aseprite binary. Once you close the file chooser, the input prompt section should be filled with a command ending with “aseprite”. Finally, add a comment and an icon (if you want to), and save. </p><p>If you want the icon to be the official Aseprite icon, navigate to <code>~/aseprite/data/icons</code>, which has a few images to choose from.</p><h1 id="Done"><a href="#Done" class="headerlink" title="Done!"></a>Done!</h1><p>Aseprite should now be accessible when searching the applications menu. It should also be pinnable to the dock.</p><p>I hope this article helped, and good luck on your pixelart journey!</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;This post details my experience compiling Aseprite (the most popular pixelart editor) for Ubuntu. It was poorly documented, so I aim to b</summary>
      
    
    
    
    
    <category term="linux, source, aseprite, pixelart" scheme="http://blog.rohanbansal.me/tags/linux-source-aseprite-pixelart/"/>
    
  </entry>
  
</feed>