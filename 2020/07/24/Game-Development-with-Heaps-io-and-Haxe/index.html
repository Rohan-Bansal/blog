<!DOCTYPE html>
<html>
<head 4.0.0-rc.2'>
  <meta charset="utf-8">
  <!-- SEO相关 -->
  
    
  
  <!-- 渲染优化 -->
  <meta name="renderer" content="webkit">
  <meta name="force-rendering" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  <meta name="HandheldFriendly" content="True" >
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <!-- 页面元数据 -->
  
  <title>2D Game Development with Heaps.io and Haxe - Blawg | Rohan Bansal</title>
  
    <meta name="keywords" content="game_development, heaps.io, haxe, 2d">
  

  

  <!-- feed -->
  
    <link rel="alternate" href="/atom.xml" title="Blawg | Rohan Bansal">
  

  <!-- import meta -->
  

  <!-- link -->
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.14/css/all.min.css">

  
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css">

  

  

  

  

  

  <!-- import link -->
  

  
  
    
<link rel="stylesheet" href="/css/style.css">

  
  

<body>
  <header class="l_header auto shadow blur" style='opacity: 0' >
  <div class='container'>
  <div class='wrapper'>
    <div class='nav-sub'>
      <p class="title"></p>
      <ul class='switcher nav-list-h m-phone' id="pjax-header-nav-list">
        <li><a class="s-comment fas fa-comments fa-fw" target="_self" href='javascript:void(0)'></a></li>
        
          <li><a class="s-toc fas fa-list fa-fw" target="_self" href='javascript:void(0)'></a></li>
        
      </ul>
    </div>
		<div class="nav-main">
      
        
        <a class="title flat-box" target="_self" href='/'>
          
            <img no-lazy class='logo' src='/img/rohan.png'/>
          
          
          
        </a>
      

			<div class='menu navigation'>
				<ul class='nav-list-h m-pc'>
          
          
          
            
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover" href=/custom.xml
                  
                  
                  
                    id="customxml"
                  >
                  <i class='fas fa-rss fa-fw'></i>RSS
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover" href=https://rbansal.dev
                  
                  
                  
                    id="https:rbansaldev"
                  >
                  <i class='fas fa-globe fa-fw'></i>Main Site
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover" href=/archives/
                  
                  
                  
                    id="archives"
                  >
                  <i class='fas fa-archive fa-fw'></i>Archives
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover" href=/about/
                  
                  
                  
                    id="about"
                  >
                  <i class='fas fa-info-circle fa-fw'></i>About
                </a>
                
              </li>
            
          
          
				</ul>
			</div>

      <div class="m_search">
        <form name="searchform" class="form u-search-form">
          <i class="icon fas fa-search fa-fw"></i>
          <input type="text" class="input u-search-input" placeholder="Search..." />
        </form>
      </div>

			<ul class='switcher nav-list-h m-phone'>
				
					<li><a class="s-search fas fa-search fa-fw" target="_self" href='javascript:void(0)'></a></li>
				
				<li>
          <a class="s-menu fas fa-bars fa-fw" target="_self" href='javascript:void(0)'></a>
          <ul class="menu-phone list-v navigation white-box">
            
              
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover" href=/custom.xml
                  
                  
                  
                    id="customxml"
                  >
                  <i class='fas fa-rss fa-fw'></i>RSS
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover" href=https://rbansal.dev
                  
                  
                  
                    id="https:rbansaldev"
                  >
                  <i class='fas fa-globe fa-fw'></i>Main Site
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover" href=/archives/
                  
                  
                  
                    id="archives"
                  >
                  <i class='fas fa-archive fa-fw'></i>Archives
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover" href=/about/
                  
                  
                  
                    id="about"
                  >
                  <i class='fas fa-info-circle fa-fw'></i>About
                </a>
                
              </li>
            
          
            
          </ul>
        </li>
			</ul>
		</div>
	</div>
  </div>
</header>

  <div class="l_body">
    <div class="l_cover">

  
  
      <div class='cover-wrapper post focus' style="display: none;">
        
          <div class='cover-bg lazyload placeholder' data-bg="/img/astronaut.jpg"></div>
        
        <div class='cover-body'>
  <div class='top'>
    
    
      <p class="title">Blawg</p>
    
    
      <p class="subtitle">My musings, experiences, and tech talks</p>
    
  </div>
  <div class='bottom'>
    <div class='menu navigation'>
      <div class='list-h'>
        
          
            <a href="/about/"
              
              
              id="about">
              <img src='https://cdn.jsdelivr.net/gh/twitter/twemoji@13.0/assets/svg/1f5c3.svg'><p>About</p>
            </a>
          
            <a href="/links/"
              
              
              id="links">
              <img src='https://cdn.jsdelivr.net/gh/twitter/twemoji@13.0/assets/svg/1f516.svg'><p>Links</p>
            </a>
          
            <a href="/subscribe/"
              
              
              id="subscribe">
              <img src='https://cdn.jsdelivr.net/gh/twitter/twemoji@13.0/assets/svg/1f4f0.svg'><p>Subscribe</p>
            </a>
          
        
      </div>
    </div>
  </div>
</div>

        <div class="scroll-down" style="display: none;"><i class="fa fa-chevron-down scroll-down-effects"></i></div>
      </div>
  

</div>

    <div class='safearea'>
      <div class='body-wrapper' id="pjax-container">
        
          <!--此文件用来存放一些不方便取值的变量-->
<!--思路大概是将值藏到重加载的区域内-->



<div id="pjax-data" style="display: none">
  <div id="pjax-ispage">true</div>
  <div id="pjax-pageTitle">2D Game Development with Heaps.io and Haxe</div>
  <div id="pjax-enable-cover">true</div>
  <div id="pjax-comment-path"></div>
  <div id="pjax-comment-placeholder"></div>
</div>


<script>
  // 处理封面 此时 jquery 还没加载
  if ("none" == "none") { // 移除封面
    document.getElementsByClassName('cover-wrapper')[0].style.display = "none";
    document.getElementsByClassName('l_header', 'cover-wrapper')[0].classList.add("show");
  } else {
    if ("none" == "half") { // 半屏
      document.getElementsByClassName('cover-wrapper')[0].setAttribute('id', 'half');
      document.getElementsByClassName('scroll-down')[0].style.display = "none";
    } else if ("none" == "full") { // 全屏
      document.getElementsByClassName('cover-wrapper')[0].setAttribute('id', 'full');
      document.getElementsByClassName('scroll-down')[0].style.display = "";
    }
    document.getElementsByClassName('cover-wrapper')[0].style.display = "";
    document.getElementsByClassName('l_header', 'cover-wrapper')[0].classList.remove("show");
  }
</script>


        
        

<div class='l_main'>
  <article class="article post white-box reveal md shadow article-type-post" id="post" itemscope itemprop="blogPost">
  


  <div class='article-header'>
    
    <div class="article-meta" id="top">
      
      
      
        <h1 class="title">
          <a href="/2020/07/24/Game-Development-with-Heaps-io-and-Haxe/">
            2D Game Development with Heaps.io and Haxe
          </a>
        </h1>
        <div class='new-meta-box'>
          
            
              
<div class='new-meta-item author'>
  <a class='author' href="/" rel="nofollow">
    <img no-lazy src="https://avatars1.githubusercontent.com/u/36248672?s=460&u=aa6e1ef0783d385055d7b3620544b29eb2a6f01b&v=4">
    <p>Rohan Bansal</p>
  </a>
</div>

            
          
            
              

            
          
            
              <div class="new-meta-item date">
  <a class='notlink'>
    <i class="fas fa-calendar-alt fa-fw" aria-hidden="true"></i>
    <p>Date : Jul 24, 2020</p>
  </a>
</div>

            
          
            
              

            
          
        </div>
      
    </div>
  </div>


  <div class="article-entry" itemprop="articleBody">
    
    
    <p><em>30 minutes to 1 hour read time. Get cozy with ur laptop or PC!</em></p>
<p>This post is meant for people who have experience in the <strong>Haxe high-level programming language</strong>, intending to make <strong>GPU-accelerated</strong>, <strong>high performance</strong> <strong>2 dimensional</strong> games in Heaps.io. This article details what Heaps is, how to get started, and many functions that one requires as a game developer. I will be adding my own experiences here and there for clarity. Note that this guide is only for <strong>2D Heaps.io</strong>, 3D you will have to look elsewhere. </p>
<h2 id="What-is-Heaps-io"><a href="#What-is-Heaps-io" class="headerlink" title="What is Heaps.io?"></a>What is Heaps.io?</h2><p>Heaps is a <strong>2D + 3D game development framework</strong> with hardware graphics acceleration support. Designed to be easily portable to new platforms, Heaps currently runs on Windows, macOS, Linux, HTML5, Android, Xbox One, Playstation 4, and Nintendo Switch. The 2D API in Heaps is similar to the Flash API (the scene graph is implemented as a Display List, just like in Flash), and at the same time, in Heaps, you can work with lower-level objects (shaders, buffers, vertices, etc.);</p>
<p><strong>Personal Note</strong></p>
<p>If you’ve worked with frameworks/editors like LibGDX, Unity, or UE4, Heaps.io is a leap in a different direction. As a nitty-gritty framework, you will have to invent specific mechanics yourself that are already included in others, such as physics and a camera (Heaps actually has a built-in camera, but it isn’t very developed). </p>
<p>Heaps.io also isn’t documented very well, but the source code is <em>extremely</em> legible and concise, so it almost makes up for that aspect. Many popular games like Dead Cells, Northgard, and even SpellBreak are developed in Heaps.io Haxe, so surpassing the steep learning curve is possible.</p>
<h2 id="Heaps-io-Package-Structure"><a href="#Heaps-io-Package-Structure" class="headerlink" title="Heaps.io Package Structure"></a>Heaps.io Package Structure</h2><p>Heaps classes are divided into <strong>4 categories (packages)</strong>:</p>
<ul>
<li><em>h2d</em> - 2D API</li>
<li><em>h3d</em> - 3D API</li>
<li><em>hxd</em> - generic classes for working with events, sounds, resources, etc.</li>
<li><em>hxsl</em> - classes related to the hxsl shader language</li>
</ul>
<h3 id="2D-Package-Base"><a href="#2D-Package-Base" class="headerlink" title="2D Package Base"></a>2D Package Base</h3><ul>
<li><em>h2d.Tile</em> - whole area or texture</li>
<li><em>h2d.Sprite</em> - Sprite, base class for displayable objects. The sprite itself cannot directly draw anything, but acts as a container for other objects</li>
<li><em>h2d.Bitmap</em> - an object that displays a texture on the screen or a specified area from a texture</li>
<li><em>h2d.Text</em> - respectively, an object that displays text on the screen</li>
</ul>
<h3 id="3D-Package-Base"><a href="#3D-Package-Base" class="headerlink" title="3D Package Base"></a>3D Package Base</h3><ul>
<li><em>h3d.scene.Object</em> - similarly to a sprite, it can act as a container for other objects in the 3d scene, but it does not itself store information about the geometry of objects on the scene</li>
<li><em>h3d.Camera</em> - a virtual camera through which you can watch the scene</li>
<li><em>h3d.scene.Mesh</em> - an object that has a geometry (for example, a cube or a sphere), as well as a material that describes how this geometry should be rendered, what shaders and textures should be used</li>
</ul>
<h3 id="Working-with-2D-and-3D-Together"><a href="#Working-with-2D-and-3D-Together" class="headerlink" title="Working with 2D and 3D Together"></a>Working with 2D and 3D Together</h3><p>Here are a few similar methods both rendering structures use:</p>
<ul>
<li>To add a nested object to the scene, both for 2D and 3D use the <code>addChild()</code> method</li>
<li>2D and 3D objects have a number of properties of the same name (<code>visible, scaleX, scaleY, name, etc.</code>)</li>
<li><em>hxd.Res</em> - macro-based resource management subsystem. It is a virtual file system with the ability to load data from different sources (from disk,  network, data embedded in the application itself)</li>
<li>Built-in event system (input events using mouse, keyboard, gamepad, network events).</li>
<li>System of shaders written in HxSL (Haxe Shader Language). HxSL shaders are essentially Haxe code and are directly embedded into the application code (without any quotes). Using macros, shaders are converted to the language supported on a specific target platform (glsl, hlsl, pssl).</li>
<li>Customizable rendering with support for modern graphic effects (for example, PBR). One of the ideas that was followed when creating Heaps is that any element of it could be easily changed. Therefore, the rendering in Heaps can be completely redone for your purposes, without making any changes to the code of the engine itself.</li>
</ul>
<h2 id="Compile-Targets"><a href="#Compile-Targets" class="headerlink" title="Compile Targets"></a>Compile Targets</h2><p>As already mentioned, Heaps can compile for different platforms:</p>
<ul>
<li><em>Flash</em> (used by Stage3D API) - You should not compile to this anymore, the platform is deprecated on major browsers</li>
<li><em>HTML5</em> (version 1.3.0 added support for WebGL 2)</li>
<li><em>HashLink</em> - A virtual machine used to run native apps. You can choose between SDL and DirectX, which are used to create the application window, draw graphics and handle events. On other desktop operating systems, only SDL is available. HashLink (and with it projects on Heaps) can also be built for modern game consoles (access to the code that provides support for these platforms is free, for access you need to contact Nicolas Cannasse). HashLink can compile to C code, making the developed game very fast.</li>
</ul>
<h2 id="Heaps-IDEs"><a href="#Heaps-IDEs" class="headerlink" title="Heaps IDEs"></a>Heaps IDEs</h2><p><strong>Personal Note</strong></p>
<p>I recommend using <a href="https://code.visualstudio.com/" target="_blank" rel="noopener">Visual Studio Code</a> to develop with Haxe and Heaps. It has a great plugin to aid debugging and development. <a href="https://www.jetbrains.com/idea/" target="_blank" rel="noopener">IntelliJ IDEA</a> and <a href="https://haxedevelop.org/" target="_blank" rel="noopener">HaxeDevelop</a> are other IDEs used to create Haxe applications.</p>
<p>Currently, HashLink applications are profiled by profiling the C code that is output (for example, using MS Visual Studio).</p>
<p>To work with the network, Nicolas recommends using his own hxbit library, an example of working with which is available in the examples distributed with Heaps - Network.hx.</p>
<h2 id="Installing-and-Configuring-the-Heaps-Environment"><a href="#Installing-and-Configuring-the-Heaps-Environment" class="headerlink" title="Installing and Configuring the Heaps Environment"></a>Installing and Configuring the Heaps Environment</h2><p>At the moment, the documentation says that Haxe version 3.4.2 or higher is required to work with Heaps. However, if you want to build a project for HashLink, then there may be incompatibilities between the Haxe and HashLink versions. Therefore, I will immediately make a reservation that when writing this material, I used the following versions of Haxe, HashLink and libraries:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Haxe 4.0.0-preview.4</span><br><span class="line">HashLink 1.7</span><br><span class="line">heaps 1.3.0</span><br><span class="line">hlsdl 1.7.0</span><br><span class="line">hldx 1.7.0</span><br><span class="line">hlopenal 1.5.0 (the audio library that hlsdl and hldx depend on)</span><br></pre></td></tr></table></figure>
<p>After downloading and unpacking HashLink, you need to add the path to its folder to the path system variable (otherwise you won’t be able to run hl files in VS Code). If you installed on Mac or Linux, then you’re good to go, no PATH modification necessary.</p>
<p>Heaps can be installed either from haxelib:</p>
<figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">haxelib install heaps</span><br></pre></td></tr></table></figure>

<p>Or install from the git version of the library:</p>
<figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">haxelib git heaps https:<span class="type"></span>//github.com/HeapsIO/heaps.git</span><br></pre></td></tr></table></figure>

<p>A set of samples is distributed with Heaps (see the samples folder). It is highly recommended that you familiarize yourself with them for a better understanding of the library.</p>
<p>In this article, we will be using VS Code as an editor.</p>
<p>To work with Haxe in VS Code, use the “Haxe Extension Pack”:</p>
<p><img src="/images/heaps_05.png" class="lazyload" data-srcset="/images/heaps_05.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt=""></p>
<h2 id="Setting-Up-a-Project"><a href="#Setting-Up-a-Project" class="headerlink" title="Setting Up a Project"></a>Setting Up a Project</h2><p>Launch VS Code, open the project folder you created (create one if you didn’t) (File -&gt; Open folder). Create two folders: <code>src</code> and <code>out</code> at the top-level.</p>
<p>Here are a few files you need to create:</p>
<ol>
<li><em>Main.hx</em> - <strong>Place this inside the <code>src</code> folder.</strong><br>The main (and only in our case) project class inherited from hxd.App (the base class for Heaps applications):</li>
</ol>
<figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Main</span> <span class="keyword"><span class="keyword">extends</span> <span class="type">hxd</span></span>.<span class="title">App</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">        <span class="keyword">new</span> <span class="type">Main</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><em>Note the capitalization difference for <code>Main</code> and <code>main</code>. Haxe, like any other language, is case-sensitive.</em></p>
<ol start="2">
<li><em>build.hxml</em> - <strong>Place this outside the <code>src</code> folder, at top level.</strong><br>The file with settings for project compilation. Set the following parameters:</li>
</ol>
<figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># imports the heaps library</span></span><br><span class="line">-lib heaps</span><br><span class="line"><span class="meta"># uses SDL (Simple DirectMedia Layer), but <span class="meta-keyword">if</span> you're on Windows, feel free to change it to "hldx"</span></span><br><span class="line">-lib hlsdl</span><br><span class="line"><span class="meta"># set the output path</span></span><br><span class="line">-hl out/hashlink/main.hl</span><br><span class="line"><span class="meta"># set window size</span></span><br><span class="line">-D windowSize=<span class="number">1366</span>x768</span><br><span class="line"><span class="meta"># set window title</span></span><br><span class="line">-D windowTitle=Test App</span><br><span class="line"><span class="meta"># set path where main file resides</span></span><br><span class="line">--class-path src</span><br><span class="line"><span class="meta"># set main class name</span></span><br><span class="line">-main Main</span><br></pre></td></tr></table></figure>

<p>After creating these files, this should be your file structure:</p>
<p>projectName<br>—out<br>—src<br>——<em>Main.hx</em><br>—<em>build.hxml</em></p>
<p>Make sure the structure looks like this, then press Ctrl-Shift-B. A dialog should pop up to select a task. Select “haxe: build.hxml”, and compile the project.</p>
<p>After that, the file main.hl should appear in the file tree inside the <code>out/hashlink</code> folder.</p>
<p>If this does not happen, then this most likely means that some process is frozen and you need to restart VS Code, the easiest way to do this is by calling the “Reload window” command - for this we call the command panel (Ctrl + Shift + P), type “reload”, and press enter.</p>
<p>Also, if your autocomplete or code jumps stop working, then most likely you just need to restart the Language Server - an auxiliary process that calls on the Haxe compiler to perform these tasks. The Language Server can also be restarted through the command bar (Ctrl + Shift + P) with the command “Haxe: Restart Language Server”.</p>
<p>Now let’s try to automate the launch of our hl file, and for this we will create a corresponding task in the project. Press F5 and select HashLink as the environment:</p>
<p><img src="/images/heaps_06.png" class="lazyload" data-srcset="/images/heaps_06.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt=""></p>
<p>In the generated code, you need to correct the name of the hxml file if it does not say <code>build.hxml</code>. Rename it to <code>build.hxml</code> otherwise.</p>
<p>Now we need to set up the default build task (Tasks -&gt; Set up default build task …) by choosing game.hxml as the task:</p>
<p><img src="/images/heaps_07.png" class="lazyload" data-srcset="/images/heaps_07.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt=""></p>
<p>In the generated task, you need to give it the name “Build” by adding the “label” field with the appropriate value (since a task with this name is searched for and launched before launching the application - it is set in launch.json by the “preLaunchTask” field):</p>
<p><img src="/images/heaps_08.png" class="lazyload" data-srcset="/images/heaps_08.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt=""></p>
<p>Having configured all the tasks, we can finally launch the application by pressing F5 - an empty window with a black background will open.</p>
<p>Besides the fact that VS Code has support for the Haxe syntax, working with Heaps and HashLink in VS Code is also convenient because the HashLink debugger is included in the extension package.</p>
<h3 id="Haxe-Program-Structure"><a href="#Haxe-Program-Structure" class="headerlink" title="Haxe Program Structure"></a>Haxe Program Structure</h3><p><em>Personal Note</em></p>
<p>If you’ve worked with other game frameworks, you may be familiar with the <code>init()</code> and <code>update()</code> methods. </p>
<p><code>init()</code> is what is called when the program starts up, and only then. It is never called after, so this function is where you create all your variables and initialize other classes.</p>
<p><code>update()</code> is called multiple times a second (anywhere from 100-500), so this is where your main game logic goes. It basically functions as a while loop, keeping the game running, updating sprites and delta time, detecting events, etc.</p>
<h3 id="Adding-Visuals"><a href="#Adding-Visuals" class="headerlink" title="Adding Visuals"></a>Adding Visuals</h3><p>Let’s now add visual objects to the scene. Let’s add a 2d image - a Bitmap object whose constructor takes 2 parameters: tile and parent.</p>
<p><code>Tile</code> describes a certain area of ​​the <code>Texture</code> (many tiles can be created from one texture). In this example, we will create a tile programmatically - from a texture filled with red. Let’s add our object to a 2d scene, which is automatically created by the engine - s2d (it is a property of the main class - h2d.App, beside it, a 3d scene is created in the application - s3d):</p>
<figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">function</span> <span class="title">init</span></span>() &#123;</span><br><span class="line">    <span class="built_in">trace</span>(<span class="string">"Hello World!"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> b = <span class="keyword">new</span> <span class="type">h2d</span>.Bitmap(h2d.Tile.fromColor(<span class="number">0xff0000</span>, <span class="number">60</span>, <span class="number">60</span>), s2d);</span><br><span class="line">    b.x = <span class="number">50</span>;</span><br><span class="line">    b.y = <span class="number">100</span>;</span><br><span class="line"></span><br><span class="line">    b.tile = b.tile.center();</span><br><span class="line">    b.rotation = Math.PI / <span class="number">4</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>In the above code, we are centering the tile (give it an anchor point). This way all transformations of the object on the screen will be calculated relative to the center of the tile. If this method is not called, then the tile will be transformed relative to its top left point. We also rotate the tile, and the rotation is given in radians.</p>
<p>You can also center the tile using the dx and dy properties of the tile.</p>
<h4 id="Coloring"><a href="#Coloring" class="headerlink" title="Coloring"></a>Coloring</h4><p>Objects in a 2D scene have many properties similar to those of DisplayObject in Flash, for example, color transformations can be configured as follows:</p>
<figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">b.color.<span class="keyword">set</span>(<span class="number">1.0</span>, <span class="number">0.0</span>, <span class="number">0.0</span>);</span><br><span class="line"></span><br><span class="line">b.colorAdd = <span class="keyword">new</span> <span class="type">h3d</span>.Vector(<span class="number">0.0</span>, <span class="number">0.0</span>, <span class="number">1.0</span>, <span class="number">0.0</span>);</span><br><span class="line">b.adjustColor(&#123;hue: <span class="type">Math</span>.random()&#125;);</span><br><span class="line"></span><br><span class="line">b.colorKey = <span class="number">0xffffffff</span>;</span><br></pre></td></tr></table></figure>

<p>Let’s add dynamics - let our object change its position over time. To do this, h2d.App has an update (dt: Float) method that I mentioned earlier that’s called every frame. Let’s override it:</p>
<figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">function</span> <span class="title">update</span></span>(dt:<span class="type">Float</span>) &#123;</span><br><span class="line">    b.rotation += <span class="number">0.01</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Now, if we compile the example (Ctrl-Shift-B, then f5), we will see a red rotating square.</p>
<h4 id="Interaction-and-User-Events"><a href="#Interaction-and-User-Events" class="headerlink" title="Interaction and User Events"></a>Interaction and User Events</h4><p>Let’s now look at how Heaps handles user input events.</p>
<p>In Heaps, unlike Flash, objects in the scene cannot themselves handle mouse events. For this, objects of type h2d.Interactive are created, which are added as child objects to the scene. Add the following code at the end of the <code>init()</code> method:</p>
<figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> i = <span class="keyword">new</span> <span class="type">h2d</span>.Interactive(b.tile.width, b.tile.height, b);</span><br><span class="line"></span><br><span class="line">i.x = <span class="number">-0.5</span> * b.tile.width;</span><br><span class="line">i.y = <span class="number">-0.5</span> * b.tile.height;</span><br><span class="line"></span><br><span class="line">i.onOver = <span class="function"><span class="keyword">function</span></span>(event : <span class="type">hxd</span>.Event) &#123;</span><br><span class="line">    b.alpha = <span class="number">0.5</span>;</span><br><span class="line">&#125; </span><br><span class="line">i.onOut = <span class="function"><span class="keyword">function</span></span>(event : <span class="type">hxd</span>.Event) &#123;</span><br><span class="line">    b.alpha = <span class="number">1.0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>As you can see, the interactive object takes a rectangular area to detect mouse input. The event detection is a handler system, with the function assigned to the event being called every time the mouse activates that event.</p>
<p>Now, when you hover the mouse over the red square, it will become semi-transparent, and when you move the mouse out, it will become opaque again.</p>
<p>In order to override the behavior of an Interactive object (the area in which mouse events are triggered), you can override its onCheck() method.<br>Also in Heaps, instead of a rectangular validation area, you can set it to an ellipse-shaped area; for this, the Interactive object has a boolean property isEllipse.</p>
<p>Handling keyboard button clicks:</p>
<figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">function</span> <span class="title">update</span></span>(dt:<span class="type">Float</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (hxd.Key.isDown(hxd.Key.RIGHT)) &#123;</span><br><span class="line">        g.x++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (hxd.Key.isDown(hxd.Key.LEFT)) &#123;</span><br><span class="line">        g.x--;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>To organize work with different tasks, the hxd.WaitEvent class has been added to Heaps, which executes the function passed to it until it returns true. Also, WaitEvent has several predefined functions, for example, for deferred method invocation:</p>
<figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> w:<span class="type">hxd</span>.WaitEvent;</span><br><span class="line"></span><br><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">function</span> <span class="title">init</span></span>() &#123;</span><br><span class="line">    w = <span class="keyword">new</span> <span class="type">hxd</span>.WaitEvent();</span><br><span class="line">    w.wait(<span class="number">2</span>, <span class="function"><span class="keyword">function</span></span>() &#123;</span><br><span class="line">        <span class="built_in">trace</span>(<span class="string">"Kept you waiting, huh?"</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">    w.add(everyFrameRoutine);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">function</span> <span class="title">update</span></span>(dt:<span class="type">Float</span>) &#123;</span><br><span class="line">    w.update(dt);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">everyFrameRoutine</span></span>(dt:<span class="type">Float</span>):<span class="type">Bool </span>&#123;</span><br><span class="line">    <span class="built_in">trace</span>(<span class="string">"everyFrameRoutine"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Images-and-Textures"><a href="#Images-and-Textures" class="headerlink" title="Images and Textures"></a>Images and Textures</h4><p>Let’s try to use an image as a texture.</p>
<p>Add a folder “res” to the project (by default, a folder with this name is used as a resource store, but if necessary, the folder name can be redefined in the project by setting the resourcesPath compilation flag as such: <code>-D resourcesPath=assets/</code>).</p>
<p>This should be the folder structure of the project now, after adding <a href="/images/logo.png">this image</a> to the assets folder:</p>
<p>projectName<br>—assets<br>——<em>logo.png</em><br>—out<br>——hashlink<br>———<em>main.hl</em><br>—src<br>——<em>Main.hx</em><br>—<em>build.hxml</em></p>
<p>Note how the above structure omits the <code>.vscode</code> folder, this is intentional, do <strong>not</strong> delete that folder.</p>
<p>Now, change this line of code:</p>
<figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">b = <span class="keyword">new</span> <span class="type">h2d</span>.Bitmap(h2d.Tile.fromColor(<span class="number">0xff0000</span>, <span class="number">60</span>, <span class="number">60</span>), s2d);</span><br></pre></td></tr></table></figure>

<p>To this:</p>
<figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">b = <span class="keyword">new</span> <span class="type">h2d</span>.Bitmap(hxd.Res.logo.toTile(), s2d);</span><br></pre></td></tr></table></figure>

<p>In the above sample, we are calling hxd (the underlying heaps library) to access the resources folder designated, find the PNG with the name “logo”, and convert it to a tile.</p>
<h4 id="Resource-Management-System-Backend"><a href="#Resource-Management-System-Backend" class="headerlink" title="Resource Management System Backend"></a>Resource Management System Backend</h4><p>Due to the fact that the resource management system is based on macros, the names of files with resources do not need to be specified as strings - they become fields of the hxd.Res class, which avoids typos in file names (messages about such errors are displayed at the compilation stage of the application).</p>
<p>In addition, based on file extensions, the resource system independently determines the type of resource (for example, jpg and png are processed as images).</p>
<p>The table of correspondence between file extensions and resource types is defined in the <code>hxd.res.Config</code> class and can be changed because is a public variable:</p>
<figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">var</span> extensions = [</span><br><span class="line">    <span class="string">"jpg,png,jpeg,gif,tga"</span> =&gt; <span class="string">"hxd.res.Image"</span>,</span><br><span class="line">    <span class="string">"fbx,hmd"</span> =&gt; <span class="string">"hxd.res.Model"</span>,</span><br><span class="line">    <span class="string">"ttf"</span> =&gt; <span class="string">"hxd.res.Font"</span>,</span><br><span class="line">    <span class="string">"fnt"</span> =&gt; <span class="string">"hxd.res.BitmapFont"</span>,</span><br><span class="line">    <span class="string">"wav,mp3,ogg"</span> =&gt; <span class="string">"hxd.res.Sound"</span>,</span><br><span class="line">    <span class="string">"tmx"</span> =&gt; <span class="string">"hxd.res.TiledMap"</span>,</span><br><span class="line">    <span class="string">"atlas"</span> =&gt; <span class="string">"hxd.res.Atlas"</span>,</span><br><span class="line">    <span class="string">"grd"</span> =&gt; <span class="string">"hxd.res.Gradients"</span>,</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">if</span> hide</span></span><br><span class="line">    <span class="string">"prefab,fx,l3d"</span> =&gt; <span class="string">"hxd.res.Prefab"</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">end</span></span></span><br><span class="line">];</span><br></pre></td></tr></table></figure>

<p>In an extreme case, resources can be loaded by file name, but the typing of resources is lost and you need to independently convert the resulting resource to its type:</p>
<figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hxd.Res.load(<span class="string">"logo.png"</span>).toImage().toTile();</span><br></pre></td></tr></table></figure>

<p>You can also create a resource from a byte array and cast it to the required type:</p>
<figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hxd.res.Any.fromBytes(...);</span><br></pre></td></tr></table></figure>

<p>But in order for the texture to actually load, it is necessary to initialize the resource system. This is done before calling the application constructor at the beginning of the app. Place the following line of code before calling <code>new Main()</code> in the <code>main()</code> method, and replace the BitMap declaration:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">class Main extends hxd.App &#123;</span><br><span class="line">    </span><br><span class="line">    var b:h2d.Bitmap;</span><br><span class="line">    </span><br><span class="line">    static function main() &#123;</span><br><span class="line">        hxd.Res.initLocal();</span><br><span class="line">        new Game();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    override function init() &#123;</span><br><span class="line">        b &#x3D; new h2d.Bitmap(hxd.Res.load(&quot;haxeLogo.png&quot;).toImage().toTile(), s2d);</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>In this example, we are calling the <code>Res.initLocal()</code> method, which means that resources will be read from the local disk system as separate files. In addition to this method, methods are available:</p>
<p><code>initEmbed()</code> - all resources will be embedded in the application file;</p>
<p><code>initPak()</code> - resources will be packed into pak files (resource archives that can be grouped according to some attribute, for example, resources of a certain game level).</p>
<p>In addition, you can independently determine how resources will be loaded (for example, over the network). Heaps implements a live reload mechanism for resources, which is activated by the pipeline (before initializing the resource system):</p>
<figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hxd.res.Resource.LIVE_UPDATE = <span class="literal">true</span>;</span><br></pre></td></tr></table></figure>

<p>And to process resource changes, you need to assign a callback, which will be called at the same time:</p>
<figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hxd.Res.logo.entry.watch(changeCallback);</span><br></pre></td></tr></table></figure>

<p>Here the entry property of <code>hxd.Res.logo</code> is an object of the virtual file system, with which the resource system works as an abstraction. Entry has its own interface, with which you can determine if entry is a folder or file, read its bytes, etc.</p>
<p>It should also be said that in Heaps unused resources are automatically removed from memory, but there are also manual methods for destroying them, for example, tiles have a <code>dispose()</code> method that removes the texture it uses from memory.</p>
<h4 id="Text-Processing-and-Display"><a href="#Text-Processing-and-Display" class="headerlink" title="Text Processing and Display"></a>Text Processing and Display</h4><p>Here are a few more important classes based around text processing:</p>
<ul>
<li>For buttons and other “stretching” elements (using 9 slice), Heaps has the <code>h2d.ScaleGrid</code> class.</li>
<li>The <code>h2d.Flow</code> component can be used for layout elements.</li>
<li>Text rendering can be done either using the <code>h2d.Text</code> class, or using <code>h2d.HtmlText</code>, which supports markup using html tags.</li>
<li>An inputable text field is implemented in the <code>h2d.TextInput</code> class.</li>
</ul>
<p>In these classes, BitMap fonts are used as fonts, which can be prepared, for example, in the bmfont program (on the net you can find many of its counterparts with a wide range of capabilities). Also, if the target platform is Flash, JS or Lime (not officially supported), then BitMap fonts can be generated programmatically from vector using the <code>hxd.res.FontBuilder</code> class:</p>
<figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fnt = hxd.res.FontBuilder.getFont(<span class="string">"Verdana"</span>, <span class="number">24</span>);</span><br></pre></td></tr></table></figure>

<p>Here’s the simplest example of using the h2d.Text class (place this in the <code>init()</code> function):</p>
<figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> t = <span class="keyword">new</span> <span class="type">h2d</span>.Text(hxd.res.DefaultFont.<span class="keyword">get</span>(), s2d);</span><br><span class="line">t.scale(<span class="number">10</span>);</span><br><span class="line"></span><br><span class="line">t.text = <span class="string">"Hello Haxe"</span>;</span><br></pre></td></tr></table></figure>

<p>This created a <code>Text</code> object with the default font, attaches it to the 2D scene, scales it up by 10, and sets the text. Building/running the project again shows the text in the window.</p>
<p><code>h2d.HtmlText</code> inherits from <code>h2d.Text</code> and working with it is no different:</p>
<figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> t = <span class="keyword">new</span> <span class="type">h2d</span>.HtmlText(hxd.res.DefaultFont.<span class="keyword">get</span>(), s2d);</span><br><span class="line">t.scale(<span class="number">10</span>);</span><br><span class="line"></span><br><span class="line">t.text = <span class="string">"Hello &lt;font color='#ff0000'&gt;Haxe&lt;/font&gt;"</span>;</span><br></pre></td></tr></table></figure>

<p><code>h2d.InputText</code> adds the ability to handle text input from the keyboard, as well as the ability to get information about the selected text fragment (using the cursorIndex and selectionRange properties):</p>
<figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> t = <span class="keyword">new</span> <span class="type">h2d</span>.TextInput(hxd.res.DefaultFont.<span class="keyword">get</span>(), s2d);</span><br><span class="line">t.scale(<span class="number">10</span>);</span><br><span class="line"></span><br><span class="line">t.text = <span class="string">"Input Here"</span>;</span><br></pre></td></tr></table></figure>

<h4 id="Tile-Batching"><a href="#Tile-Batching" class="headerlink" title="Tile Batching"></a>Tile Batching</h4><p>Next up, tile batching! There are 2 classes for batching tiles in Heaps:</p>
<ul>
<li><em>h2d.TileGroup</em> - for static groups whose elements do not change their relative position</li>
<li><em>h2d.SpriteBatch</em> - for dynamic groups</li>
</ul>
<p>An example of using h2d.TileGroup:</p>
<figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> g:<span class="type">h2d</span>.TileGroup;</span><br><span class="line"></span><br><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">function</span> <span class="title">init</span></span>() &#123;</span><br><span class="line">    <span class="keyword">var</span> tiles = hxd.Res.logo.toTile().gridFlatten(<span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    g = <span class="keyword">new</span> <span class="type">h2d</span>.TileGroup(tiles[<span class="number">0</span>], s2d);</span><br><span class="line">    g.blendMode = None;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (i <span class="keyword">in</span> <span class="number">0.</span>.<span class="number">.1000</span>) &#123;</span><br><span class="line">        g.add(Std.random(s2d.width), Std.random(s2d.height), tiles[i % tiles.length]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">function</span> <span class="title">update</span></span>(dt:<span class="type">Float</span>) &#123;</span><br><span class="line">    g.rotation += <span class="number">0.01</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Since the TileGroup class is optimized for rendering static elements, transformations of the entire group cost almost nothing in terms of performance! That is, you can change the position, scale, and rotation of the group without slowing down the application speed, no matter how many elements there are.</p>
<p>Consider creating simple 2d animations using the h2d.Anim class:</p>
<figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> animationSpeed = <span class="number">15</span>;</span><br><span class="line">b = <span class="keyword">new</span> <span class="type">h2d</span>.Anim(hxd.Res.logo.toTile().split(<span class="number">10</span>, <span class="literal">false</span>), animationSpeed, s2d);</span><br></pre></td></tr></table></figure>

<p>Here we split the texture into 10 horizontal frames, set the animation speed and add an animated sprite to the scene.</p>
<p>Of course, for an animated sprite, you can manually change the animation speed, set the current frame, pause the animation, etc. (in general, do whatever is expected of animation):</p>
<figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">b.currentFrame = <span class="number">1</span>;</span><br><span class="line">b.pause = <span class="literal">true</span>;</span><br><span class="line">b.speed = <span class="number">10</span>;</span><br></pre></td></tr></table></figure>

<h4 id="Shape-Rendering-Geometric-Primitives"><a href="#Shape-Rendering-Geometric-Primitives" class="headerlink" title="Shape Rendering / Geometric Primitives"></a>Shape Rendering / Geometric Primitives</h4><p>To draw geometric primitives in Heaps, such as shapes, objects of the <code>h2d.Graphics</code> type are used (there is also <code>h3d.scene.Graphics</code>, which works with a 3D scene), which are similar to <code>flash.display.Graphics</code> in Flash, but at the same time are an element of the scene, and not a property of sprites:</p>
<figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> g:<span class="type">h2d</span>.Graphics;</span><br><span class="line"></span><br><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">function</span> <span class="title">init</span></span>() &#123;</span><br><span class="line">    g = <span class="keyword">new</span> <span class="type">h2d</span>.Graphics(s2d);</span><br><span class="line"></span><br><span class="line">    g.beginFill(<span class="number">0xff00ff</span>, <span class="number">0.5</span>);</span><br><span class="line">    g.drawCircle(<span class="number">150</span>, <span class="number">150</span>, <span class="number">100</span>);</span><br><span class="line">    g.endFill()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>At the same time, unlike OpenFL (another Haxe game development library), all primitives are rendered entirely by means of the GPU, without consuming additional memory, and are also stored in a buffer (that is, each frame is not recalculated).</p>
<h1 id="Done"><a href="#Done" class="headerlink" title="Done!"></a>Done!</h1><p>Hopefully after going through this guide, you’ve become more acquainted and proficient with 2D Heaps.io. With a library like this, understanding the documentation can be critical to your game, and I hope I’ve cleared some things up. </p>
<p>Have fun with game development! Feel free to share any cool projects with me at <a href="mailto:bansalrohan18@gmail.com">bansalrohan18@gmail.com</a>.</p>

    
      
      <div class='footer'>
        
        
        
          <div class='copyright'>
            <blockquote>
              
                
                  
                
              
                
                  <p><a href=http://blog.rbansal.dev/2020/07/24/Game-Development-with-Heaps-io-and-Haxe/>http://blog.rbansal.dev/2020/07/24/Game-Development-with-Heaps-io-and-Haxe/</a></p>
                
              
            </blockquote>
          </div>
        
        
      </div>
    
  </div>
  
    


  <div class='article-meta' id="bottom">
    <div class='new-meta-box'>
      
        
          <div class="new-meta-item date" itemprop="dateUpdated" datetime="2020-09-21T11:14:53-07:00">
  <a class='notlink'>
    <i class="fas fa-edit fa-fw" aria-hidden="true"></i>
    <p>Updated : Sep 21, 2020</p>
  </a>
</div>

        
      
        
          
  
  <div class="new-meta-item meta-tags"><a class="tag" href="/tags/game-development-heaps-io-haxe-2d/" rel="nofollow"><i class="fas fa-hashtag fa-fw" aria-hidden="true"></i><p>game_development, heaps.io, haxe, 2d</p></a></div>


        
      
        
      
    </div>
  </div>


  
  

  
    <div class="prev-next">
      
        <a class='prev' href='/2020/09/19/Workshop-Templated-Robot-Emails/'>
          <p class='title'><i class="fas fa-chevron-left" aria-hidden="true"></i>Workshop - Templated Robot Emails</p>
          <p class='content'>Robotic Emails
Overview
In this workshop, you’ll be using good ol’ Python to send emails using a ...</p>
        </a>
      
      
        <a class='next' href='/2020/07/02/My-Experience-Theming-Windows-10/'>
          <p class='title'>My Experience Theming Windows 10<i class="fas fa-chevron-right" aria-hidden="true"></i></p>
          <p class='content'>I recently dove into the world of Windows 10 theming, and thought I should share my experience. I...</p>
        </a>
      
    </div>
  
</article>



</div>
<aside class='l_side'>
  
  
    
    



  <section class="widget toc-wrapper shadow desktop mobile" id="toc-div" >
    
  <header>
    
      <i class="fas fa-list fa-fw" aria-hidden="true"></i><span class='name'>Contents</span>
    
  </header>


    <div class='content'>
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#What-is-Heaps-io"><span class="toc-text">What is Heaps.io?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Heaps-io-Package-Structure"><span class="toc-text">Heaps.io Package Structure</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2D-Package-Base"><span class="toc-text">2D Package Base</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3D-Package-Base"><span class="toc-text">3D Package Base</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Working-with-2D-and-3D-Together"><span class="toc-text">Working with 2D and 3D Together</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Compile-Targets"><span class="toc-text">Compile Targets</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Heaps-IDEs"><span class="toc-text">Heaps IDEs</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Installing-and-Configuring-the-Heaps-Environment"><span class="toc-text">Installing and Configuring the Heaps Environment</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Setting-Up-a-Project"><span class="toc-text">Setting Up a Project</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Haxe-Program-Structure"><span class="toc-text">Haxe Program Structure</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Adding-Visuals"><span class="toc-text">Adding Visuals</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Coloring"><span class="toc-text">Coloring</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Interaction-and-User-Events"><span class="toc-text">Interaction and User Events</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Images-and-Textures"><span class="toc-text">Images and Textures</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Resource-Management-System-Backend"><span class="toc-text">Resource Management System Backend</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Text-Processing-and-Display"><span class="toc-text">Text Processing and Display</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Tile-Batching"><span class="toc-text">Tile Batching</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Shape-Rendering-Geometric-Primitives"><span class="toc-text">Shape Rendering &#x2F; Geometric Primitives</span></a></li></ol></li></ol></li></ol>
    </div>
  </section>


  


</aside>



      </div>
      
  
  <footer class="footer clearfix">
    <br><br>
    
      
        <div class="aplayer-container">
          


        </div>
      
    
      
        <br>
        <div class="social-wrapper">
          
            
              <a href="/atom.xml"
                class="social  flat-btn"
                target="_blank"
                rel="external nofollow noopener noreferrer">
                
                  <img src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-org@1.1/icon/1322024-social-media/020-rss.svg" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/volantis-x/cdn-org@1.1/icon/1322024-social-media/020-rss.svg" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="/>
                
              </a>
            
          
            
          
            
              <a href="https://github.com/rohan-bansal"
                class="social  flat-btn"
                target="_blank"
                rel="external nofollow noopener noreferrer">
                
                  <img src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-org@1.1/icon/1322024-social-media/029-github.svg" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/volantis-x/cdn-org@1.1/icon/1322024-social-media/029-github.svg" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="/>
                
              </a>
            
          
            
              <a href="https://twitter.com/rbansal22"
                class="social  flat-btn"
                target="_blank"
                rel="external nofollow noopener noreferrer">
                
                  <img src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-org@1.1/icon/1322024-social-media/018-twitter.svg" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/volantis-x/cdn-org@1.1/icon/1322024-social-media/018-twitter.svg" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="/>
                
              </a>
            
          
            
              <a href="/"
                class="social  flat-btn"
                target="_blank"
                rel="external nofollow noopener noreferrer">
                
                  <img src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-org@1.1/icon/1322024-social-media/045-telegram.svg" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/volantis-x/cdn-org@1.1/icon/1322024-social-media/045-telegram.svg" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="/>
                
              </a>
            
          
        </div>
      
    
      
        <div><p>Blog content follows the <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en" target="_blank" rel="noopener">Attribution-NonCommercial-ShareAlike 4.0 International (CC BY-NC-SA 4.0) License</a></p>
</div>
        <div><p><i>Banner drawn by Tithi Luadthong</i></p></div>
        <div><p><strong>Based on Volantis</strong></p></div>
      
    
      
        
      
    
      
         
      
    
      
        <div class='copyright'>
        <p><a href="/">Copyright © 2019-2020 Rohan Bansal</a></p>

        </div>
      
    
  </footer>


      <a class="s-top fas fa-arrow-up fa-fw" href='javascript:void(0)'></a>
    </div>
  </div>
  <div>
    
    <!-- required -->

<script src="https://cdn.jsdelivr.net/npm/jquery@3.5/dist/jquery.min.js"></script>

<script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>
<script>
  function pjax_fancybox() {
    $(".md").find("img").not('.inline').not('a img').each(function () { //渲染 fancybox
      var element = document.createElement("a"); // a 标签
      $(element).attr("class", "fancybox");
      $(element).attr("pjax-fancybox", "");  // 过滤 pjax
      $(element).attr("href", $(this).attr("src"));
      if ($(this).attr("data-original")) {
        $(element).attr("href", $(this).attr("data-original"));
      }
      $(element).attr("data-fancybox", "images");
      var caption = "";   // 描述信息
      if ($(this).attr('alt')) {  // 判断当前页面是否存在描述信息
        $(element).attr('data-caption', $(this).attr('alt'));
        caption = $(this).attr('alt');
      }
      var div = document.createElement("div");
      $(div).addClass("fancybox");
      $(this).wrap(div); // 最外层套 div ，其实主要作用还是 class 样式
      var span = document.createElement("span");
      $(span).addClass("image-caption");
      $(span).text(caption); // 加描述
      $(this).after(span);  // 再套一层描述
      // 背景层
      var bgDiv = document.createElement("div");
      $(bgDiv).addClass("bg");
      if ($(this).attr('bg')) {
        $(bgDiv).css('background', $(this).attr('bg'));
      }
      $(this).wrap(bgDiv); // 背景层
      $(this).wrap(element);  // 最后套 a 标签
    })
    $(".article-entry").find("img").fancybox({
      selector: '[data-fancybox="images"]',
      hash: false,
      loop: false,
      closeClick: true,
      helpers: {
        overlay: {closeClick: true}
      },
      buttons: [
        "zoom",
        "close"
      ]
    });
  };
  $(function () {
    pjax_fancybox();
  });
</script>


<!-- internal -->



<!-- optional -->

  <script>
  
  var SEARCH_SERVICE = "hexo" || "hexo";
  var ROOT = "/" || "/";
  if (!ROOT.endsWith('/')) ROOT += '/';
</script>




  <script defer src="https://cdn.jsdelivr.net/npm/vanilla-lazyload@17.1.0/dist/lazyload.min.js"></script>
<script>
  // https://www.npmjs.com/package/vanilla-lazyload
  // Set the options globally
  // to make LazyLoad self-initialize
  window.lazyLoadOptions = {
    elements_selector: ".lazyload",
    threshold: 0
  };
  // Listen to the initialization event
  // and get the instance of LazyLoad
  window.addEventListener(
    "LazyLoad::Initialized",
    function (event) {
      window.lazyLoadInstance = event.detail.instance;
    },
    false
  );
  document.addEventListener('DOMContentLoaded', function () {
    lazyLoadInstance.update();
  });
  document.addEventListener('pjax:complete', function () {
    lazyLoadInstance.update();
  });
</script>




  
  
    <script>
      window.FPConfig = {
        delay: 0,
        ignoreKeywords: [],
        maxRPS: 5,
        hoverDelay: 25
      };
    </script>
    <script defer src="https://cdn.jsdelivr.net/gh/gijo-varghese/flying-pages@2.1.2/flying-pages.min.js"></script>
  




  <script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
<script>
    var clipboard = new ClipboardJS('.btn-copy', {
        target: function (trigger) {
            return trigger.nextElementSibling
        }
    });
    function wait(callback, seconds) {
        var timelag = null;
        timelag = window.setTimeout(callback, seconds)
    }
    function pjax_initCopyCode() {
		if($(".highlight .code pre").length+$(".article pre code").length==0)return;
        var copyHtml = '';
        copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
        copyHtml += '<i class="fas fa-copy"></i><span>COPY</span>';
        copyHtml += '</button>';
        $(".highlight .code pre").before(copyHtml);
        $(".article pre code").before(copyHtml);
        clipboard.off('success').on('success', function (e) {
            let $btn = $(e.trigger);
            $btn.addClass('copied');
            let $icon = $($btn.find('i'));
            $icon.removeClass('fa-copy');
            $icon.addClass('fa-check-circle');
            let $span = $($btn.find('span'));
            $span[0].innerText = 'COPIED';
            wait(function () {
                $icon.removeClass('fa-check-circle');
                $icon.addClass('fa-copy');
                $span[0].innerText = 'COPY'
            }, 2000)
        });
        clipboard.off('error').on('error', function (e) {
            e.clearSelection();
            let $btn = $(e.trigger);
            $btn.addClass('copy-failed');
            let $icon = $($btn.find('i'));
            $icon.removeClass('fa-copy');
            $icon.addClass('fa-times-circle');
            let $span = $($btn.find('span'));
            $span[0].innerText = 'COPY FAILED';
            wait(function () {
                $icon.removeClass('fa-times-circle');
                $icon.addClass('fa-copy');
                $span[0].innerText = 'COPY'
            }, 2000)
        })
    }
    $(function () {
        pjax_initCopyCode()
    });
</script>








  
  
<script src="/js/valine.js"></script>


<script>
  var GUEST_INFO = ['nick', 'mail', 'link'];
  var meta = 'nick,mail,link'.split(',').filter(function (item) {
    return GUEST_INFO.indexOf(item) > -1
  });
  var REQUIRED_FIELDS = ['nick', 'mail', 'link'];
  var requiredFields = 'nick,mail'.split(',').filter(function (item) {
    return REQUIRED_FIELDS.indexOf(item) > -1
  });

  function emoji(path, idx, ext) {
    return path + "/" + path + "-" + idx + "." + ext;
  }

  var emojiMaps = {};
  for (var i = 1; i <= 54; i++) {
    emojiMaps['tieba-' + i] = emoji('tieba', i, 'png');
  }
  for (var i = 1; i <= 101; i++) {
    emojiMaps['qq-' + i] = emoji('qq', i, 'gif');
  }
  for (var i = 1; i <= 116; i++) {
    emojiMaps['aru-' + i] = emoji('aru', i, 'gif');
  }
  for (var i = 1; i <= 125; i++) {
    emojiMaps['twemoji-' + i] = emoji('twemoji', i, 'png');
  }
  for (var i = 1; i <= 4; i++) {
    emojiMaps['weibo-' + i] = emoji('weibo', i, 'png');
  }

  function pjax_valine() {
    if(!document.querySelectorAll("#valine_container")[0])return;

    let pagePlaceholder = $.trim($('#pjax-comment-placeholder').text()) || "Write something!";

    let path = $.trim($('#pjax-comment-path').text());
    if (path.length == 0) {
      let defaultPath = '';
      path = defaultPath || decodeURI(window.location.pathname);
    }

    var valine = new Valine();
    valine.init({
      el: '#valine_container',
      meta: meta,
      placeholder: pagePlaceholder,
      path: path,
      appId: "",
      appKey: "",
      pageSize: '10',
      avatar: 'robohash',
      lang: 'en',
      visitor: 'true',
      highlight: 'true',
      mathJax: 'false',
      enableQQ: 'true',
      requiredFields: requiredFields,
      emojiCDN: 'https://cdn.jsdelivr.net/gh/volantis-x/cdn-emoji/valine/',
      emojiMaps: emojiMaps
    })
  }

  $(function () {
    pjax_valine();
  });
</script>







  
<script src="/js/app.js"></script>




  
    
<script src="/js/search.js"></script>

  











<!-- more -->


    
      


<script src="https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.min.js"></script>

<!-- 样式位于：source/css/_third-party/pjaxanimate.styl -->

<div class="pjax-animate">
  
    <script src="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js"></script>
    <div id="loading-bar-wrapper"><script>NProgress.configure({parent:"#loading-bar-wrapper",trickleSpeed: 100})</script></div>
    <script>
      window.ShowLoading = function() {
        NProgress.start();
      };
      window.HideLoading = function() {
        NProgress.done();
      }
    </script>
  
</div>

<script>
    var pjax;
    document.addEventListener('DOMContentLoaded', function () {
      pjax = new Pjax({
        elements: 'a[href]:not([href^="#"]):not([href="javascript:void(0)"]):not([pjax-fancybox])',
        selectors: [
          "title",
          "#pjax-container",
          "#pjax-header-nav-list"
        ],
        cacheBust: false,   // url 地址追加时间戳，用以避免浏览器缓存
        timeout: 5000
      });
    });

    document.addEventListener('pjax:send', function (e) {
      window.stop(); // 相当于点击了浏览器的停止按钮

      try {
        var currentUrl = window.location.pathname;
        var targetUrl = e.triggerElement.href;
        var banUrl = [""];
        if (banUrl[0] != "") {
          banUrl.forEach(item => {
            if(currentUrl.indexOf(item) != -1 || targetUrl.indexOf(item) != -1) {
              window.location.href = targetUrl;
            }
          });
        }
      } catch (error) {}

      window.subData = null; // 移除标题（用于一二级导航栏切换处）
      $.fancybox.close();    // 关闭弹窗
      $('.l_header .switcher .s-search').removeClass('active'); // 关闭移动端激活的搜索框
      $('.l_header').removeClass('z_search-open'); // 关闭移动端激活的搜索框
      $('.wrapper').removeClass('sub'); // 跳转页面时关闭二级导航

      // 解绑事件 避免重复监听
      $('.s-top').unbind('click');
      $('.menu a').unbind('click');
      $(window).unbind('resize');
      $(window).unbind('scroll');
      $(document).unbind('scroll');
      $(document).unbind('click');
      $('body').unbind('click');
      window.ShowLoading();
    });

    document.addEventListener('pjax:complete', function () {
      // 关于百度统计对 SPA 页面的处理：
      // 方案一：百度统计>管理>单页应用设置中，打开开启按钮即可对SPA进行统计。 https://tongji.baidu.com/web/help/article?id=324
      // 方案二：取消注释下列代码。 https://tongji.baidu.com/web/help/article?id=235
      // 

      // 关于谷歌统计对 SPA 页面的处理：
      // 当应用以动态方式加载内容并更新地址栏中的网址时，也应该更新通过 gtag.js 存储的网页网址。
      // https://developers.google.cn/analytics/devguides/collection/gtagjs/single-page-applications?hl=zh-cn
      

      $('.nav-main').find('.list-v').not('.menu-phone').removeAttr("style",""); // 移除小尾巴的移除
      $('.menu-phone.list-v').removeAttr("style",""); // 移除小尾巴的移除
      $('script[data-pjax], .pjax-reload script').each(function () {
        $(this).parent().append($(this).remove());
      });
      try{
        pjax_fancybox();
        
        
        
        
          pjax_initCopyCode();
        
        
          pjax_valine();
        
        
        
        
        
      } catch (e) {
        console.log(e);
      }
      window.HideLoading();
    });

    document.addEventListener('pjax:error', function (e) {
      window.HideLoading();
      window.location.href = e.triggerElement.href;
    });
</script>

    
  </div>

  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>
  <script async>

    function post(path, params, method='post') {

        // The rest of this code assumes you are not using a library.
        // It can be made less wordy if you use one.
        const form = document.createElement('form');
        form.method = method;
        form.action = path;

        for (const key in params) {
          if (params.hasOwnProperty(key)) {
            const hiddenField = document.createElement('input');
            hiddenField.type = 'hidden';
            hiddenField.name = key;
            hiddenField.value = params[key];

            form.appendChild(hiddenField);
          }
        }

        document.body.appendChild(form);
        form.submit();
    }

    var done = false;

    async function fireSwal(done) {
        if(!done) {
        const { value: email } = await Swal.fire({
              title: 'Subscribe To My Newsletter!',
              input: 'email',
              inputLabel: 'If you would like to get news of recent articles straight to your inbox!',
              inputPlaceholder: 'email'
            })

            if (email) {
              Swal.fire(`Successfully Subscribed!`)
              post('https://rohanbansal.us10.list-manage.com/subscribe/post', {
                "u":"eb650c2d4e1adedd983e74b4e",
                "id":"3c40ef0756",
                "MERGE0":`${email}`,
              })
              //    window.location.href="/";
            }
        done = true;
      }
    }

    // setTimeout(() => fireSwal(done), 8000);



  </script>
</body>

</html>
